<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Krustlet – </title>
    <link>https://docs.krustlet.dev/en/howto/</link>
    <description>Recent content on Krustlet</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    
	  <atom:link href="https://docs.krustlet.dev/en/howto/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/bootstrapping/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/bootstrapping/</guid>
      <description>
        
        
        &lt;h1 id=&#34;bootstrapping-krustlet&#34;&gt;Bootstrapping Krustlet&lt;/h1&gt;
&lt;p&gt;As of version 0.3.0, Krustlet supports automatic bootstrapping of its
authorization and serving certificates. This document describes how the
functionality works.&lt;/p&gt;
&lt;h2 id=&#34;initialization&#34;&gt;Initialization&lt;/h2&gt;
&lt;p&gt;Krustlet follows the same &lt;a href=&#34;https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#initialization-process&#34;&gt;initialization
flow&lt;/a&gt;
as Kubelet (with the exception of automatic renewal of certs that are close to
expiry).&lt;/p&gt;
&lt;h2 id=&#34;instructions&#34;&gt;Instructions&lt;/h2&gt;
&lt;p&gt;In order to join a cluster with the proper permissions, Krustlet requires a
valid bootstrap config with a valid bootstrap token. This token can be generated
with
&lt;a href=&#34;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/&#34;&gt;&lt;code&gt;kubeadm&lt;/code&gt;&lt;/a&gt;
or may already exist depending on your provider. However, in this case, we will
be using an easier method for creating a join token. Either way, the examples
here should be useful for figuring out how to do it differently depending on
your setup.&lt;/p&gt;
&lt;h3 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h3&gt;
&lt;p&gt;You will need &lt;code&gt;kubectl&lt;/code&gt;
&lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/install-kubectl/&#34;&gt;installed&lt;/a&gt; and a
kubeconfig that has access to create &lt;code&gt;Secrets&lt;/code&gt; in the &lt;code&gt;kube-system&lt;/code&gt; namespace
and can approve &lt;code&gt;CertificateSigningRequests&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;generating-a-token-and-kubeconfig&#34;&gt;Generating a token and kubeconfig&lt;/h3&gt;
&lt;p&gt;We have a useful bootstrapping &lt;a href=&#34;./assets/bootstrap.sh&#34;&gt;bash script&lt;/a&gt; or
&lt;a href=&#34;./assets/bootstrap.sh&#34;&gt;Powershell script&lt;/a&gt; that can be used for generating a
token and creating a bootstrap kubeconfig file. If you have cloned the repo, you
can run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ./docs/howto/assets/bootstrap.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;OR&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ .\docs\howto\assets\bootstrap.ps1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you are the trusting sort, you can pipe it in from the internet:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ bash &amp;lt;(curl https://raw.githubusercontent.com/deislabs/krustlet/master/docs/howto/assets/bootstrap.sh)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;OR&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#204a87&#34;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;-UseBasicParsing&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;https&lt;/span&gt;&lt;span style=&#34;color:#a40000&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;//&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;raw&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;githubusercontent&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;com&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;deislabs&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;krustlet&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;master&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;docs&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;howto&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;assets&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;bootstrap&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ps1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Content&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#204a87&#34;&gt;Invoke-Expression&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This will output a ready-to-use bootstrap config to
&lt;code&gt;$HOME/.krustlet/config/bootstrap.conf&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;script-configuration&#34;&gt;Script configuration&lt;/h4&gt;
&lt;p&gt;The script also exposes a few configuration options by means of environment
variables. These are detailed in the table below:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;th&gt;Default&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CONFIG_DIR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The location of your configuration directory for Krustlet. Should be the same as &lt;code&gt;$KRUSTLET_DATA_DIR/config&lt;/code&gt; where the &lt;code&gt;KRUSTLET_DATA_DIR&lt;/code&gt; setting is the same one you use for configuring Krustlet&lt;/td&gt;
&lt;td&gt;&lt;code&gt;$HOME/.krustlet/config&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;FILE_NAME&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;The name of the file the bootstrap config should be saved to&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bootstrap.conf&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;nitty-gritty-details&#34;&gt;Nitty-gritty details&lt;/h4&gt;
&lt;p&gt;This section contains an overview of the nitty-gritty details for those who may
be constructing their own bootstrapping setup. Feel free to skip this section if
it doesn&amp;rsquo;t pertain to you.&lt;/p&gt;
&lt;h5 id=&#34;bootstrap-tokens&#34;&gt;Bootstrap tokens&lt;/h5&gt;
&lt;p&gt;A bootstrap token has the format of &lt;code&gt;[a-z0-9]{6}.[a-z0-9]{16}&lt;/code&gt; where the first
part is a randomly generated token id and the second part after the &lt;code&gt;.&lt;/code&gt; needs to
be a cryptographically secure random string. The token will look something like
this: &lt;code&gt;ke3uxh.vhxb3ttj1nquno5t&lt;/code&gt;. That means you can generate a token with a
simple bash command like so:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ echo &amp;quot;$(&amp;lt; /dev/urandom tr -dc a-z0-9 | head -c${1:-6};echo;).$(&amp;lt; /dev/urandom tr -dc a-z0-9 | head -c${1:-16};echo;)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;creating-the-secret&#34;&gt;Creating the secret&lt;/h5&gt;
&lt;p&gt;To actually &amp;ldquo;create&amp;rdquo; the bootstrap token, it needs to be placed in a &lt;code&gt;Secret&lt;/code&gt; in
the &lt;code&gt;kube-system&lt;/code&gt; namespace. The name of the secret should be
&lt;code&gt;bootstrap-token-&amp;lt;token_id&amp;gt;&lt;/code&gt;. Specifically, the secret should look something
like this when you send it to the API:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Secret&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;bootstrap-token-&amp;lt;token_id&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;namespace&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;kube-system&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;type&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;bootstrap.kubernetes.io/token&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;stringData&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;auth-extra-groups&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;system:bootstrappers:kubeadm:default-node-token&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;expiration&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;2020-06-04T20:07:24Z&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;token-id&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;&amp;lt;token_id&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;token-secret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;&amp;lt;token_secret&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;usage-bootstrap-authentication&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;usage-bootstrap-signing&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The main fields you need to set are &lt;code&gt;token-id&lt;/code&gt;, &lt;code&gt;token-secret&lt;/code&gt;, and
&lt;code&gt;expiration&lt;/code&gt;.&lt;/p&gt;
&lt;h5 id=&#34;generating-the-kubeconfig&#34;&gt;Generating the Kubeconfig&lt;/h5&gt;
&lt;p&gt;Once you have a &lt;code&gt;Secret&lt;/code&gt; created, you then have to generate the Kubeconfig. To
do so, you&amp;rsquo;ll need several pieces of information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The CA cert for your Kubernetes API. This should be available from the
kubeconfig you are currently using&lt;/li&gt;
&lt;li&gt;The server hostname or IP address&lt;/li&gt;
&lt;li&gt;The generated bootstrap token&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can either assemble a kubeconfig by hand or use similar steps to what is
found in the &lt;a href=&#34;./assets/bootstrap.sh&#34;&gt;bootstrap script&lt;/a&gt;&lt;/p&gt;
&lt;h5 id=&#34;an-example-bootstrap-config&#34;&gt;An example bootstrap config&lt;/h5&gt;
&lt;p&gt;This is an example of a bootstrap config file for reference if creating your own
workflow&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;clusters&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;cluster&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;certificate-authority-data&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwdGFXNXAKYTNWaVpVTkJNQjRYRFRFNE1EUXlOREF3TVRVME9Wb1hEVEk0TURReU1UQXdNVFUwT1Zvd0ZURVRNQkVHQTFVRQpBeE1LYldsdWFXdDFZbVZEUVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS1lxCnhzMllBNzRETlFQTVZkbFJ3aXZFWnIwd0lTUHlQZjkzR3ZsUVNKMDQrbFgxSEF3Yi9GM3dqcDVEckVOSDAraTUKbjhZUy9QK3JlNUpqVU9tV1VmMXNtMmVLNHNRNHpNS01kMHc5by9ERlozTHc3K1h6RzMveTdvMkF4SWVlYjBPdgpzbzhwWUVOMklzRUcrRFhpa0l0MjhPZ1RtZGRhTVg1OWJQTXhGL0l6T1FPVmFEYmtnMk5ScWtjYW9CR0FTT2JkCkVId2hrVGdMYXZCNzVnVmRTVVlWUFU1M2dXc3hDQWVBYzNCaW9NekNLNmFFUXIrMDB4V3dEWkR4amxLYU02V3gKTWFQN0JmY0Y5K2U3OUt0Tkc3TXZMWG9xdFJ3cCtPdWREaTlKWHRLS1NNbVo3TFNubEY4UDdHUlhKL2IzNS9NVQpvQklkK1ZKNHpoak5zT2xKM3g4Q0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUNCZ2dyQmdFRkJRY0RBVEFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFDWmM0SVpST3pnNS91eDdNa0Y3NmVja3dZekY4OUJiejRhRENVS3ByWUMxTDFvZVBVawpXdFc3VENWditDMDJRc2tGRnpTbGhlQUpYeXp5Q2xKMVE5VmUyUmR2bGtiZHVPTXpJeXZTS0xaZHVDT2pvVWNZCjkrMTN1UEFpaXJjNUpRZlBOTGdJcUdhbTB2ZXpqZEtROHNUK0o0WmRyNHdFOUZKQnhOeUhob0xQdjBLRENBbkcKWFlPZW5lTHdjcnJCcTVDTERRN2dIelZGbEFKVU1nSWF3ZzdtcG1HVi9KRlVlYnRpam1Cd1p1WDBNMTFpVHBqYQpNaUhDRkJOREd5a2locDBoSHdDV1ZId0ZXNHVLUWxUZjRBK2hieC9OTUkzbHhBYXozMFZKN3U1Mm1GR3pCQ0dvCmt3VjdKS2RJMEd1MGJQQmlUSDRMTmE4bWxqYmZkRnhsc2k4cAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;server&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;https://192.168.64.19:8443&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;minikube&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;contexts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;context&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;cluster&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;minikube&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;namespace&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;kube-system&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;user&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tls-bootstrap-token-user&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tls-bootstrap-token-user@kubernetes&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;current-context&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tls-bootstrap-token-user@kubernetes&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Config&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;preferences&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;users&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;tls-bootstrap-token-user&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;user&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;token&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ke3uxh.vhxb3ttj1nquno5t&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;running-krustlet&#34;&gt;Running Krustlet&lt;/h3&gt;
&lt;p&gt;Once you have the bootstrap config in place, you can run Krustlet:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ KUBECONFIG=~/.krustlet/config/kubeconfig krustlet-wasi --port 3000 --bootstrap-file /path/to/your/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Krustlet will begin the bootstrapping process, and then &lt;strong&gt;await manual
certificate approval&lt;/strong&gt; (described below) before launching.&lt;/p&gt;
&lt;p&gt;A couple important notes here. &lt;code&gt;KUBECONFIG&lt;/code&gt; should almost always be set,
especially in developer/local machine situations. During the bootstrap process,
Krustlet will generate a kubeconfig with the credentials it obtains during the
bootstrapping process and write it out to the specified location in
&lt;code&gt;KUBECONFIG&lt;/code&gt;. If a kubeconfig already exists there, it will be loaded and skip
the bootstrapping process. A similar process occurs during the bootstrapping of
the serving certificates, they will be written out to the paths specified by
&lt;code&gt;--cert-file&lt;/code&gt; (default &lt;code&gt;$KRUSTLET_DATA_DIR/config/krustlet.crt&lt;/code&gt;) and
&lt;code&gt;--private-key-file&lt;/code&gt; (default &lt;code&gt;$KRUSTLET_DATA_DIR/config/krustlet.key&lt;/code&gt;). If they
already exist, then they will be loaded and bootstrapping skipped.&lt;/p&gt;
&lt;h3 id=&#34;approving-the-serving-csr&#34;&gt;Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup). The client certs Krustlet needs are
generally approved automatically by the API. However, the serving certs require
manual approval. To do this, you&amp;rsquo;ll need the hostname you specified for the
&lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t specify anything.
Then run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once you do this, Krustlet will automatically grab the new certs and start
running.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/csi/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/csi/</guid>
      <description>
        
        
        &lt;h1 id=&#34;registering-a-csi-driver&#34;&gt;Registering a CSI Driver&lt;/h1&gt;
&lt;p&gt;For more information on what is the Container Storage Interface and how it
relates to a CSI driver, see the &lt;a href=&#34;../topics/csi.md&#34;&gt;topic guide&lt;/a&gt; for more
information.&lt;/p&gt;
&lt;p&gt;A Krustlet Provider with CSI support will check for new drivers registered to
the &lt;code&gt;plugins/&lt;/code&gt; directory (by default, this is &lt;code&gt;$HOME/.krustlet/plugins&lt;/code&gt;). You
will need to inform your CSI driver to bind its socket at that location in order
for a Provider to recognize and register the driver.&lt;/p&gt;
&lt;p&gt;You will also need to install and run the following projects so that the
PersistentVolumeClaim&amp;rsquo;s volume will be provisioned and readily available for
use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes-csi/node-driver-registrar&#34;&gt;node-driver-registrar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes-csi/external-provisioner&#34;&gt;external-provisioner&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Do keep in mind that some CSI drivers rely on linux-specific command line
tooling like &lt;code&gt;mount&lt;/code&gt;, so these tools may only work on Linux. Cross-platform
support is not guaranteed. Refer to the driver&amp;rsquo;s documentation for more
information.&lt;/p&gt;
&lt;h2 id=&#34;how-do-i-use-a-csi-volume&#34;&gt;How do I use a CSI Volume?&lt;/h2&gt;
&lt;p&gt;Assuming a CSI storage plugin is already deployed on your cluster, you can use
it through familiar Kubernetes storage primitives: PersistentVolumeClaims,
PersistentVolumes, and StorageClasses.&lt;/p&gt;
&lt;p&gt;A basic example to start with would be the &lt;a href=&#34;https://github.com/kubernetes-csi/csi-driver-host-path&#34;&gt;host-path CSI
driver&lt;/a&gt;. This project is
not recommended for use in production, but will work as an example.&lt;/p&gt;
&lt;p&gt;To start, we&amp;rsquo;ll need to create a StorageClass. A StorageClass provides a way for
administrators to describe the &amp;ldquo;classes&amp;rdquo; of storage they offer. Different
classes might map to quality-of-service levels, or to backup policies, or to
arbitrary policies determined by the cluster administrators. Kubernetes itself
is unopinionated about what classes represent. This concept is sometimes called
&amp;ldquo;profiles&amp;rdquo; in other storage systems.&lt;/p&gt;
&lt;p&gt;The following StorageClass enables dynamic creation of &amp;ldquo;csi-hostpath-sc&amp;rdquo; volumes
by a CSI volume plugin called &amp;ldquo;hostpath.csi.k8s.io&amp;rdquo;. This storage class will
also allow for &lt;a href=&#34;https://github.com/kubernetes-csi/external-resizer&#34;&gt;volume
expansion&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;storage.k8s.io/v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;StorageClass&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;csi-hostpath-sc&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;provisioner&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hostpath.csi.k8s.io&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;reclaimPolicy&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Delete&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumeBindingMode&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Immediate&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;allowVolumeExpansion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After installing a StorageClass, we can start creating PersistentVolumeClaims to
provision and prepare volumes. These will be mounted to Kubernetes Pods that
request it as a volume. Note how the PVC requests the same StorageClass we
created earlier.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;PersistentVolumeClaim&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;csi-pvc&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;accessModes&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#000&#34;&gt;ReadWriteOnce&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;resources&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;requests&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;storage&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;1Gi&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;storageClassName&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;csi-hostpath-sc&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A Pod can then request that volume to be mounted by using the &lt;code&gt;volumes&lt;/code&gt; API.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;my-frontend&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;containers&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;my-frontend&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;image&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;example.com/my-frontend:v1.0.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumeMounts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;mountPath&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;/data&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;my-csi-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumes&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;my-csi-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;persistentVolumeClaim&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;claimName&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;csi-pvc&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When the pod referencing a CSI volume is scheduled, Krustlet will trigger the
appropriate operations against the external CSI plugin (ControllerPublishVolume,
NodePublishVolume, etc.) to ensure the specified volume is attached, mounted,
and ready to use by the containers in the pod.&lt;/p&gt;
&lt;h2 id=&#34;addendum-role-based-access-control&#34;&gt;Addendum: Role-based Access Control&lt;/h2&gt;
&lt;p&gt;In the event that the Pod is erroring saying that the kubelet doesn&amp;rsquo;t have the
correct admission controls to access storage classes, you&amp;rsquo;ll have to create the
following cluster role and role binding to allow the &lt;code&gt;system:nodes&lt;/code&gt; group to
access them:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ClusterRole&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;storageclass-reader&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;rules&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiGroups&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;storage.k8s.io&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;resources&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;storageclasses&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;verbs&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;watch&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;list&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;---&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ClusterRoleBinding&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;node-storageclass-reader&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;subjects&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Group&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;system:nodes&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiGroup&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;roleRef&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiGroup&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ClusterRole&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;storageclass-reader&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-azure/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-azure/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-azure&#34;&gt;Running Krustlet on Azure&lt;/h1&gt;
&lt;p&gt;This guide demonstrates how to run Krustlet on Azure.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;This guide will require both &lt;a href=&#34;https://docs.microsoft.com/en-us/cli/azure/install-azure-cli&#34;&gt;the Azure
CLI&lt;/a&gt; as well as
&lt;code&gt;kubectl&lt;/code&gt; to connect to the cluster after it has been provisioned.&lt;/p&gt;
&lt;p&gt;This specific tutorial will run Krustlet on another Azure Virtual Machine within
the same Virtual Network as the Kubernetes cluster.&lt;/p&gt;
&lt;h2 id=&#34;step-1-creating-a-service-principal&#34;&gt;Step 1: Creating a Service Principal&lt;/h2&gt;
&lt;p&gt;Prior to deploying Krustlet, a Service Principal needs to exist.&lt;/p&gt;
&lt;p&gt;The following Azure CLI command can be used to create a Service Principal. Make
sure to change &lt;code&gt;ServicePrincipalName&lt;/code&gt; with your own unique name for a Service
Principal.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ az ad sp create-for-rbac --name ServicePrincipalName --skip-assignment
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The output for a service principal with password authentication includes the
password key. Make sure you copy this value - it can&amp;rsquo;t be retrieved. If you
forget the password, &lt;a href=&#34;https://docs.microsoft.com/en-us/cli/azure/create-an-azure-service-principal-azure-cli#reset-credentials&#34;&gt;reset the service principal
credentials&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The ID and password appears in the output of &lt;code&gt;az ad sp create-for-rbac&lt;/code&gt; and are
used in the ARM template&amp;rsquo;s parameters. Make sure to record their values for
later use.&lt;/p&gt;
&lt;h2 id=&#34;step-2-generate-an-ssh-key&#34;&gt;Step 2: Generate an SSH Key&lt;/h2&gt;
&lt;p&gt;You will also need to generate an SSH key. This will be used to SSH into the
machines for debugging purposes&amp;hellip; Or if you&amp;rsquo;re just curious and want to see
&lt;a href=&#34;https://en.wiktionary.org/wiki/how_the_sausage_gets_made&#34;&gt;how the sausage is
made&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Follow the guide on Github to &lt;a href=&#34;https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent&#34;&gt;generate a new SSH
key&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;step-3-click-the-button&#34;&gt;Step 3: Click the Button&lt;/h2&gt;
&lt;p&gt;Go ahead. Click the button.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fdeislabs%2Fkrustlet%2Fmaster%2Fcontrib%2Fazure%2Fazuredeploy.json&#34;&gt;&lt;img src=&#34;https://aka.ms/deploytoazurebutton&#34; alt=&#34;Deploy ToAzure&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Copy the content of your public key and paste it into the &amp;ldquo;SSH Public Key&amp;rdquo;
parameter. Also make sure to copy and paste the content of your Service
Principal&amp;rsquo;s client ID (&lt;code&gt;appID&lt;/code&gt;) and password into the parameters.&lt;/p&gt;
&lt;h2 id=&#34;step-3b-troubleshooting&#34;&gt;Step 3(b): Troubleshooting&lt;/h2&gt;
&lt;p&gt;In case the deployment fails, inspect the raw error message Azure reports from
the failed deployment. The deployment could fail due to a name collision, and
the raw error logs could help determine what went wrong.&lt;/p&gt;
&lt;h2 id=&#34;step-4-test-that-things-work&#34;&gt;Step 4: Test that things work&lt;/h2&gt;
&lt;p&gt;Once the cluster has been deployed, now you can see things work! Connect to the
cluster and feel free to give any of the demos a try like so:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ az aks get-credentials --name krustlet --resource-group my-resource-group
$ kubectl apply -f demos/wasi/hello-world-rust/k8s.yaml
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# wait a few seconds for the pod to run&lt;/span&gt;
$ kubectl logs hello-world-wasi-rust
hello from stdout!
hello from stderr!
&lt;span style=&#34;color:#000&#34;&gt;CONFIG_MAP_VAL&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;cool stuff
&lt;span style=&#34;color:#000&#34;&gt;FOO&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;bar
&lt;span style=&#34;color:#000&#34;&gt;POD_NAME&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;hello-world-wasi-rust
Args are: &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;[]&lt;/span&gt;

Bacon ipsum dolor amet chuck turducken porchetta, tri-tip spare ribs t-bone ham hock. Meatloaf
pork belly leberkas, ham beef pig corned beef boudin ground round meatball alcatra jerky.
Pancetta brisket pastrami, flank pork chop ball tip short loin burgdoggen. Tri-tip kevin
shoulder cow andouille. Prosciutto chislic cupim, short ribs venison jerky beef ribs ham hock
short loin fatback. Bresaola meatloaf capicola pancetta, prosciutto chicken landjaeger andouille
swine kielbasa drumstick cupim tenderloin chuck shank. Flank jowl leberkas turducken ham tongue
beef ribs shankle meatloaf drumstick pork t-bone frankfurter tri-tip.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;step-5-tear-it-down&#34;&gt;Step 5: Tear it down&lt;/h2&gt;
&lt;p&gt;After you&amp;rsquo;re done testing, delete the cluster with&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ az group delete -n my-resource-group
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-do/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-do/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-managed-kubernetes-on-digitalocean&#34;&gt;Running Krustlet on Managed Kubernetes on DigitalOcean&lt;/h1&gt;
&lt;p&gt;These steps are for running a Krustlet node on a DigitalOcean Droplet in a
Managed Kubernetes DigitalOcean cluster.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a Managed Kubernetes on DigitalOcean cluster. See the &lt;a href=&#34;kubernetes-on-do.md&#34;&gt;how-to
guide for running Managed Kubernetes on DigitalOcean&lt;/a&gt; for
more information.&lt;/p&gt;
&lt;p&gt;This tutorial runs Krustlet on a DigitalOcean Droplet (VM); however you may
follow these steps from any device that can start a web server on an IP
accessible from the Kubernetes control plane.&lt;/p&gt;
&lt;p&gt;In the &lt;a href=&#34;kubernetes-on-do.md&#34;&gt;how-to guide for running Managed Kubernetes on DigitalOcean&lt;/a&gt;,
several environment variables were used to define the cluster. Let&amp;rsquo;s reuse
those values:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ CLUSTER=[[YOUR-CLUSTER-NAME]]
$ VERSION=&amp;quot;1.19.3-do.3&amp;quot;
$ SIZE=&amp;quot;s-1vcpu-2gb&amp;quot;
$ REGION=&amp;quot;sfo3&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s also confirm that the cluster exists:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl kubernetes cluster list
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-1-create-digitalocean-droplet-vm&#34;&gt;Step 1: Create DigitalOcean Droplet (VM)&lt;/h2&gt;
&lt;p&gt;As with the cluster, there are several values (size, region) that you will need
to determine before you create the Droplet. &lt;code&gt;doctl compute&lt;/code&gt; includes commands
to help you determine slugs for these values:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl compute size list
$ doctl compute region list
$ doctl compute image list --public
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you&amp;rsquo;d prefer, you may use the values below. However, it is strongly
recommended that you use SSH keys to authenticate with Droplets. DigitalOcean
provides &lt;a href=&#34;https://www.digitalocean.com/docs/droplets/how-to/add-ssh-keys/&#34;&gt;instructions&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You may then list your SSH keys:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl compute ssh-key list
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; In this case, you reference the key using an &lt;code&gt;ID&lt;/code&gt; value&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We can create a new DigitalOcean Droplet using the following command:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ INSTANCE=[[YOUR-INSTANCE-NAME]]
$ SIZE=&amp;quot;s-1vcpu-2gb&amp;quot;   # Need not be the same size as the cluster node(s)
$ REGION=&amp;quot;sfo3&amp;quot;        # Need not be the same region as the cluster
IMAGE=&amp;quot;debian-10-x64&amp;quot;
SSH_KEY=[[YOUR-SSH-KEY]]

doctl compute droplet create ${INSTANCE} \
--region ${REGION} \
--size ${SIZE} \
--ssh-keys ${SSH_KEY} \
--tag-names krustlet,wasm \
--image ${IMAGE}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; The service will response with an &lt;code&gt;ID&lt;/code&gt; value for the Droplet. As long
as the Droplet name (&lt;code&gt;INSTANCE&lt;/code&gt;) is unique, you may refer to the Droplet by its
name value too.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You will need the Droplet&amp;rsquo;s IPv4 public address so make a note of it (&lt;code&gt;IP&lt;/code&gt;):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl compute droplet get ${INSTANCE} \
  --format PublicIPv4 \
  --no-header
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-2-get-a-bootstrap-config-for-your-kustlet-node&#34;&gt;Step 2: Get a bootstrap config for your Kustlet node&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt;, setting the &lt;code&gt;CONFIG_DIR&lt;/code&gt; variable to &lt;code&gt;./&lt;/code&gt;,
to generate a bootstrap config and then return to this document. If you already
have a kubeconfig available that you generated through another process, you can
proceed to the next step. However, the credentials Krustlet uses must be part of
the &lt;code&gt;system:nodes&lt;/code&gt; group in order for things to function properly.&lt;/p&gt;
&lt;p&gt;NOTE: You may be wondering why you can&amp;rsquo;t run this on the VM you just
provisioned. We need access to the Kubernetes API in order to create the
bootstrap token, so the script used to generate the bootstrap config needs to be
run on a machine with the proper Kubernetes credentials.&lt;/p&gt;
&lt;h2 id=&#34;step-3-copy-bootstrap-config-to-droplet&#34;&gt;Step 3: Copy bootstrap config to Droplet&lt;/h2&gt;
&lt;p&gt;The first thing we&amp;rsquo;ll need to do is copy up the assets we generated in steps 1
and 2. Copy them to the VM by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;scp -i ${PRIVATE_KEY} \
  ${HOME}/.krustlet/config/bootstrap.conf \
  root@${IP}:.
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; &lt;code&gt;IP&lt;/code&gt; is the Droplet&amp;rsquo;s IPv4 address from step #1 and &lt;code&gt;PRIVATE_KEY&lt;/code&gt; is
the location of the file containing the private (!) key that corresponds to the
public key that you used when you created the Droplet.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We can then SSH into the Droplet by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl compute ssh ${INSTANCE} \
  --ssh-key-path ${PRIVATE_KEY}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you&amp;rsquo;d prefer, you may use &lt;code&gt;ssh&lt;/code&gt; directly:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ssh -i ${PRIVATE_KEY} root@${IP}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-4-install-and-configure-kruslet&#34;&gt;Step 4: Install and configure Kruslet&lt;/h2&gt;
&lt;p&gt;Install the latest release of krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s use the built-in &lt;code&gt;krustlet-wasi&lt;/code&gt; provider:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ KUBECONFIG=${PWD}/kubeconfig ${PWD}/krustlet-wasi \
  --node-ip=${IP} \
  --node-name=&amp;quot;krustlet&amp;quot; \
  --bootstrap-file=${PWD}/bootstrap.conf \
  --cert-file=${PWD}/krustlet.crt \
  --private-key-file=${PWD}/krustlet.key
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; You&amp;rsquo;ll need the &lt;code&gt;IP&lt;/code&gt; of the Droplet from step 1.
&lt;strong&gt;NOTE&lt;/strong&gt; To increase the level of debugging, you may prefix the command with
&lt;code&gt;RUST_LOG=info&lt;/code&gt; or &lt;code&gt;RUST_LOG=debug&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you restart the Krustlet after successfully (!) bootstrapping, you may run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ KUBECONFIG=${PWD}/kubeconfig ${PWD}/krustlet-wasi \
  --node-ip=${IP} \
  --node-name=&amp;quot;krustlet&amp;quot; \
  --cert-file=${PWD}/krustlet.crt \
  --private-key-file=${PWD}/krustlet.key
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If bootstrapping fails, you should delete the CSR and try to bootstrap again:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl delete csr ${INSTANCE}-tls
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-4a-approving-the-serving-csr&#34;&gt;Step 4a: Approving the serving CSR&lt;/h2&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve ${INSTANCE}-tls
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You should be able to enumerate the cluster&amp;rsquo;s nodes including the Krustlet by
typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                           STATUS   ROLES    AGE   VERSION
krustlet                       Ready    &amp;lt;none&amp;gt;   60s   0.5.0
${CLUSTER}-default-pool-39yh5  Ready    &amp;lt;none&amp;gt;   10m   v1.19.3
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-5-test-that-things-work&#34;&gt;Step 5: Test that things work&lt;/h2&gt;
&lt;p&gt;We may test that the Krustlet is working by running one of the demos:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl apply --filename=https://raw.githubusercontent.com/deislabs/krustlet/master/demos/wasi/hello-world-rust/k8s.yaml
$ kubectl get pods
NAME                    READY   STATUS       RESTARTS   AGE
hello-world-wasi-rust   0/1     ExitCode:0   0          12s

$ kubectl logs pods/hello-world-wasi-rust
hello from stdout!
hello from stderr!
FOO=bar
CONFIG_MAP_VAL=cool stuff
POD_NAME=hello-world-wasi-rust
Args are: []

Bacon ipsum dolor amet chuck turducken porchetta, tri-tip spare ribs t-bone ham hock. Meatloaf
pork belly leberkas, ham beef pig corned beef boudin ground round meatball alcatra jerky.
Pancetta brisket pastrami, flank pork chop ball tip short loin burgdoggen. Tri-tip kevin
shoulder cow andouille. Prosciutto chislic cupim, short ribs venison jerky beef ribs ham hock
short loin fatback. Bresaola meatloaf capicola pancetta, prosciutto chicken landjaeger andouille
swine kielbasa drumstick cupim tenderloin chuck shank. Flank jowl leberkas turducken ham tongue
beef ribs shankle meatloaf drumstick pork t-bone frankfurter tri-tip.
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-6-run-krustlet-as-a-service&#34;&gt;Step 6: Run Krustlet as a service&lt;/h2&gt;
&lt;p&gt;Create &lt;code&gt;krustlet.service&lt;/code&gt; in &lt;code&gt;/etc/systemd/system/krustlet.service&lt;/code&gt; on the VM.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;[Unit]
Description=Krustlet, a kubelet implementation for running WASM

[Service]
Restart=on-failure
RestartSec=5s
Environment=KUBECONFIG=/etc/krustlet/config/kubeconfig
Environment=KRUSTLET_NODE_IP=[[REPLACE-WITH-IP]]
Environment=KRUSTLET_NODE_NAME=krustlet
Environment=KRUSTLET_CERT_FILE=/etc/krustlet/config/krustlet.crt
Environment=KRUSTLET_PRIVATE_KEY_FILE=/etc/krustlet/config/krustlet.key
Environment=KRUSTLET_DATA_DIR=/etc/krustlet
Environment=RUST_LOG=wasi_provider=info,main=info
ExecStart=/usr/local/bin/krustlet-wasi
User=root
Group=root

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ensure that the &lt;code&gt;krustlet.service&lt;/code&gt; has the correct ownership and permissions
with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo chown root:root /etc/systemd/system/krustlet.service
$ sudo chmod 644 /etc/systemd/system/krustlet.service
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo mkdir -p /etc/krustlet/config &amp;amp;&amp;amp; sudo chown -R root:root /etc/krustlet
$ sudo mv {krustlet.*,kubeconfig} /etc/krustlet/config &amp;amp;&amp;amp; chmod 600 /etc/krustlet/*
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once you have done that, run the following commands to make sure the unit is
configured to start on boot:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo systemctl enable krustlet &amp;amp;&amp;amp; sudo systemctl start krustlet
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You may confirm the status of the service and review logs using:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ systemctl status krustlet.service
$ journalctl --unit=krustlet.service --follow

## Delete the VM

When you are finished with the VM, you can delete it by typing:

```console
$ doctl compute droplet delete ${INSTANCE}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When you are finished with the cluster, you can delete it by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl kubernetes cluster delete ${CLUSTER}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;doctl kubernetes cluster delete&lt;/code&gt; will also attempt to delete the cluster&amp;rsquo;s
configuration (cluster, context, user) from the default Kubernetes config file
(Linux: &lt;code&gt;${HOME}/.kube/config&lt;/code&gt;). You will neeed to set a new default context.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-eks/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-eks/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-amazon-elastic-kubernetes-service-eks&#34;&gt;Running Krustlet on Amazon Elastic Kubernetes Service (EKS)&lt;/h1&gt;
&lt;p&gt;Currently, &lt;a href=&#34;https://github.com/aws/containers-roadmap/issues/741&#34;&gt;EKS does not
support&lt;/a&gt; running managed
node groups with custom Amazon Machine Images (AMI).&lt;/p&gt;
&lt;p&gt;However, it does appear the feature might be coming soon.&lt;/p&gt;
&lt;p&gt;Until that time, we can use &lt;a href=&#34;https://eksctl.io/&#34;&gt;eksctl&lt;/a&gt; to create and manage a
node group with a custom Krustlet-based AMI.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;The following tools are needed to complete this walkthrough:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/cli/&#34;&gt;Amazon CLI&lt;/a&gt; - &lt;em&gt;use &lt;code&gt;aws configure&lt;/code&gt; to set your
access keys and default region&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://packer.io/&#34;&gt;Packer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://eksctl.io/&#34;&gt;eksctl&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;building-the-krustlet-based-ami&#34;&gt;Building the Krustlet-based AMI&lt;/h2&gt;
&lt;p&gt;We will be using &lt;a href=&#34;https://packer.io/&#34;&gt;Packer&lt;/a&gt; to spin up an EC2 instance to
build the AMI.&lt;/p&gt;
&lt;p&gt;There is a Makefile in &lt;code&gt;docs/howto/assets/eks&lt;/code&gt; that will run &lt;code&gt;packer&lt;/code&gt; for you.
It will use a &lt;code&gt;c5.2xlarge&lt;/code&gt; EC2 instance to build the AMI with.  Use the
&lt;code&gt;instance_type&lt;/code&gt; variable to &lt;code&gt;make&lt;/code&gt; to change the type of the EC2 instance used.&lt;/p&gt;
&lt;p&gt;Run &lt;code&gt;make&lt;/code&gt; to build the AMI:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ cd docs/howto/assets/eks
$ make
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You can also build the AMI with a different version of Krustlet from a forked
repo. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ cd docs/howto/assets/eks
$ KRUSTLET_VERSION=$(git rev-parse --short HEAD) KRUSTLET_SRC=https://github.com/jingweno/krustlet/archive/$(git rev-parse --short HEAD).tar.gz make krustlet
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This command will take a while to build Krustlet from source on the EC2
instance. In the future, a prebuilt binary for Amazon Linux 2 might be available
that would speed up the AMI creation process.&lt;/p&gt;
&lt;p&gt;If everything works correctly, you should see the command complete with output
similar to:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;...
==&amp;gt; Builds finished. The artifacts of successful builds are:
--&amp;gt; amazon-ebs: AMIs were created:
us-west-2: ami-07adf9ce893885a3d

--&amp;gt; amazon-ebs:
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Make note of the AMI identifier (in the example output above it would be
&lt;code&gt;ami-07adf9ce893885a3d&lt;/code&gt;) as it will be used to create the EKS cluster.&lt;/p&gt;
&lt;h2 id=&#34;creating-the-eks-cluster&#34;&gt;Creating the EKS cluster&lt;/h2&gt;
&lt;p&gt;We will be using &lt;a href=&#34;https://eksctl.io/&#34;&gt;eksctl&lt;/a&gt; to deploy the EKS cluster.&lt;/p&gt;
&lt;p&gt;Create a file named &lt;code&gt;cluster.yaml&lt;/code&gt; with the following contents, replacing the
&lt;code&gt;region&lt;/code&gt; and &lt;code&gt;ami&lt;/code&gt; fields with your values:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;eksctl.io/v1alpha5&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ClusterConfig&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;krustlet-demo&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;region&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;&amp;lt;YOUR_AWS_REGION_HERE&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;version&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;1.15&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nodeGroups&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;krustlet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;ami&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;&amp;lt;YOUR_AMI_HERE&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;instanceType&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;t3.small&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;minSize&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;maxSize&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;desiredCapacity&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;ssh&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;allow&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;overrideBootstrapCommand&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;/etc/eks/bootstrap.sh --krustlet-node-labels &amp;#34;alpha.eksctl.io/cluster-name=krustlet-demo,alpha.eksctl.io/nodegroup-name=krustlet&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This will create a EKS cluster named &lt;code&gt;krustlet-demo&lt;/code&gt; with a single unmanaged
node group named &lt;code&gt;krustlet&lt;/code&gt; with two &lt;code&gt;t3.small&lt;/code&gt; nodes.&lt;/p&gt;
&lt;p&gt;Be aware that the &lt;code&gt;overrideBootstrapCommand&lt;/code&gt; setting is required to properly
boot the nodes. Without it, the Krustlet service will not be started and the
nodes will not automatically join the cluster.&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;eksctl&lt;/code&gt; to create the cluster:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ eksctl create cluster -f cluster.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This command will take a long time to run as it provisions the EKS cluster and
nodes.&lt;/p&gt;
&lt;p&gt;Eventually, the command will be stuck on the following output:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;...
[ℹ]  waiting for at least 1 node(s) to become ready in &amp;#34;krustlet&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With another shell, ensure the nodes have joined the cluster:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                                          STATUS   ROLES   AGE   VERSION
ip-192-168-24-34.us-west-2.compute.internal   Ready    agent   23s   v1.17.0
ip-192-168-44-27.us-west-2.compute.internal   Ready    agent   17s   v1.17.0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You should see two nodes with different names in the output.&lt;/p&gt;
&lt;h2 id=&#34;running-a-webassembly-application&#34;&gt;Running a WebAssembly application&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s deploy a demo WebAssembly application to the cluster:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl apply -f demos/wasi/hello-world-rust/k8s.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Check that the pod ran to completion:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get pod hello-world-wasi-rust
NAME                    READY   STATUS       RESTARTS   AGE
hello-world-wasi-rust   0/1     ExitCode:0   0          7s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This output shows the pod completed with an exit code of 0.&lt;/p&gt;
&lt;p&gt;Take a look at the log to see the output of the application:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl logs hello-world-wasi-rust
hello from stdout!
hello from stderr!
POD_NAME=hello-world-wasi-rust
FOO=bar
CONFIG_MAP_VAL=cool stuff
Args are: []
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Congratulations!  You&amp;rsquo;ve run a WebAssembly program on an EKS cluster!&lt;/p&gt;
&lt;h2 id=&#34;deleting-the-cluster&#34;&gt;Deleting the cluster&lt;/h2&gt;
&lt;p&gt;Use &lt;code&gt;eksctl&lt;/code&gt; to delete the cluster and the nodes:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ eksctl delete cluster --name krustlet-demo
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;deleting-the-krustlet-ami&#34;&gt;Deleting the Krustlet AMI&lt;/h2&gt;
&lt;p&gt;Determine the snapshot identifier of the AMI, where &lt;code&gt;$AMI_ID&lt;/code&gt; is the identifier
of your Krustlet AMI:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ aws ec2 describe-images --image-ids $AMI_ID | grep SnapshotId
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Use &lt;code&gt;aws&lt;/code&gt; to deregister the AMI, where &lt;code&gt;$AMI_ID&lt;/code&gt; is the identifier of your
Krustlet AMI:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ aws ec2 deregister-image --image-id $AMI_ID
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, delete the snapshot, where &lt;code&gt;$SNAPSHOT_ID&lt;/code&gt; is the previously determined
snapshot identifier:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ aws ec2 delete-snapshot --snapshot-id $SNAPSHOT_ID
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-gke/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-gke/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-google-kubernetes-engine-gke&#34;&gt;Running Krustlet on Google Kubernetes Engine (GKE)&lt;/h1&gt;
&lt;p&gt;These steps are for running a Krustlet node in a GKE cluster.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a GKE cluster. See the &lt;a href=&#34;kubernetes-on-gke.md&#34;&gt;how-to guide for running Kubernetes on
GKE&lt;/a&gt; for more information.&lt;/p&gt;
&lt;p&gt;This specific tutorial will be running Krustlet on a Compute Engine VM; however
you may follow these steps from any device that can start a web server on an IP
accessible from the Kubernetes control plane.&lt;/p&gt;
&lt;p&gt;In the &lt;a href=&#34;kubernetes-on-gke.md&#34;&gt;how-to guide for running Kubernetes on GKE&lt;/a&gt;,
several environment variables were used to define a Google Cloud Platform
project, region and Kubernetes Engine cluster. Let&amp;rsquo;s reuse those values:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ PROJECT=[YOUR-PROJECT] # Perhaps $(whoami)-$(date +%y%m%d)-krustlet
$ REGION=&amp;quot;us-west1&amp;quot; # Use a region close to you `gcloud compute regions list --project=${PROJECT}`
$ CLUSTER=&amp;quot;cluster&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s confirm that the cluster exists. We can do this using either &lt;code&gt;gcloud&lt;/code&gt; or
&lt;code&gt;kubectl&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud container clusters describe ${CLUSTER} --project=${PROJECT} --region=${REGION}
$ gcloud container clusters describe ${CLUSTER} --project=${PROJECT} --region=${REGION} --format=&amp;quot;value(status)&amp;quot;
RUNNING
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Or:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                                     STATUS   ROLES    AGE     VERSION
gke-cluster-default-pool-1a3a5b85-scds   Ready    &amp;lt;none&amp;gt;   1m      v1.17.4-gke.10
gke-cluster-default-pool-3885c0e3-6zw2   Ready    &amp;lt;none&amp;gt;   1m      v1.17.4-gke.10
gke-cluster-default-pool-6d70a85d-19r8   Ready    &amp;lt;none&amp;gt;   1m      v1.17.4-gke.10
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; If you chose to create a single-zone cluster, replace
&lt;code&gt;--region=${REGION}&lt;/code&gt; with &lt;code&gt;--zone=${ZONE}&lt;/code&gt; in the above &lt;code&gt;gcloud&lt;/code&gt; commands.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;step-1-create-compute-engine-vm&#34;&gt;Step 1: Create Compute Engine VM&lt;/h2&gt;
&lt;p&gt;We can create a new VM with the following command:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ INSTANCE=&amp;quot;krustlet&amp;quot; # Name of this VM must matches the certificate&#39;s CN
$ # The cluster is distributed across the zones in the region
$ # For the VM, we&#39;ll pick one of the zones
$ ZONE=&amp;quot;${REGION}-a&amp;quot; # Pick one of the zones in this region
$ gcloud beta compute instances create ${INSTANCE} \
--project=${PROJECT} \
--zone=${ZONE} \
--machine-type &amp;quot;n1-standard-1&amp;quot; \
--image-family=&amp;quot;debian-10&amp;quot; \
--image-project=&amp;quot;debian-cloud&amp;quot;
NAME      ZONE        MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP     STATUS
krustlet  us-west1-a  n1-standard-1               xx.xx.xx.xx  yy.yy.yy.yy     RUNNING
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It should take less than 30-seconds to provision the VM.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s determine the instance&amp;rsquo;s internal (!) IP to use when creating the
Kubernete certificate and subsequently running Krustlet. In step #4, you&amp;rsquo;ll need
to copy this value into the command that is used to run Krustlet on the VM:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ IP=$(gcloud compute instances describe ${INSTANCE} \
--project=${PROJECT} \
--zone=${ZONE} \
--format=&amp;quot;value(networkInterfaces[0].networkIP)&amp;quot;) &amp;amp;&amp;amp; echo ${IP}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-2-get-a-bootstrap-config-for-your-krustlet-node&#34;&gt;Step 2: Get a bootstrap config for your Krustlet node&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt;, setting the &lt;code&gt;CONFIG_DIR&lt;/code&gt; variable to &lt;code&gt;./&lt;/code&gt;,
to generate a bootstrap config and then return to this document. If you already
have a kubeconfig available that you generated through another process, you can
proceed to the next step. However, the credentials Krustlet uses must be part of
the &lt;code&gt;system:nodes&lt;/code&gt; group in order for things to function properly.&lt;/p&gt;
&lt;p&gt;NOTE: You may be wondering why you can&amp;rsquo;t run this on the VM you just
provisioned. We need access to the Kubernetes API in order to create the
bootstrap token, so the script used to generate the bootstrap config needs to be
run on a machine with the proper Kubernetes credentials&lt;/p&gt;
&lt;h2 id=&#34;step-3-copy-bootstrap-config-to-vm&#34;&gt;Step 3: Copy bootstrap config to VM&lt;/h2&gt;
&lt;p&gt;The first thing we&amp;rsquo;ll need to do is copy up the assets we generated in steps 1
and 2. Copy them to the VM by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud compute scp bootstrap.conf ${INSTANCE}: --project=${PROJECT} --zone=${ZONE}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can then SSH into the instance by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud compute ssh ${INSTANCE} --project=${PROJECT} --zone=${ZONE}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-4-install-and-configure-krustlet&#34;&gt;Step 4: Install and configure Krustlet&lt;/h2&gt;
&lt;p&gt;Install the latest release of krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s use the built-in &lt;code&gt;krustlet-wasi&lt;/code&gt; provider:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ KUBECONFIG=${PWD}/kubeconfig krustlet-wasi \
--hostname=&amp;quot;krustlet&amp;quot; \
--node-ip=${IP} \
--node-name=&amp;quot;krustlet&amp;quot; \
--bootstrap-file=./bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; To increase the level of debugging, you may prefix the command with
&lt;code&gt;RUST_LOG=info&lt;/code&gt; or &lt;code&gt;RUST_LOG=debug&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; The value of &lt;code&gt;${IP}&lt;/code&gt; was determined in step #1.&lt;/p&gt;
&lt;h3 id=&#34;step-4a-approving-the-serving-csr&#34;&gt;Step 4a: Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NOTE: You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine&lt;/p&gt;
&lt;p&gt;You should be able to enumerate the cluster&amp;rsquo;s nodes including the Krustlet by
typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                                     STATUS   ROLES    AGE   VERSION
gke-cluster-default-pool-1a3a5b85-scds   Ready    &amp;lt;none&amp;gt;   59m   v1.17.4-gke.10
gke-cluster-default-pool-3885c0e3-6zw2   Ready    &amp;lt;none&amp;gt;   36m   v1.17.4-gke.10
gke-cluster-default-pool-6d70a85d-19r8   Ready    &amp;lt;none&amp;gt;   59m   v1.17.4-gke.10
krustlet                                 Ready    agent    8s    v1.17.0
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-5-test-that-things-work&#34;&gt;Step 5: Test that things work&lt;/h2&gt;
&lt;p&gt;We may test that the Krustlet is working by running one of the demos:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl apply --filename=https://raw.githubusercontent.com/deislabs/krustlet/master/demos/wasi/hello-world-rust/k8s.yaml
$ # wait a few seconds for the pod to run
$ kubectl logs pods/hello-world-wasi-rust
hello from stdout!
hello from stderr!
CONFIG_MAP_VAL=cool stuff
FOO=bar
POD_NAME=hello-world-wasi-rust
Args are: []
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; you may receive an &lt;code&gt;ErrImagePull&lt;/code&gt; and &lt;code&gt;Failed to pull image&lt;/code&gt; and
&lt;code&gt;failed to generate container&lt;/code&gt;. This results if the taints do not apply
correctly. You should be able to resolve this issue, using the following YAML.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ConfigMap&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-world-wasi-rust&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;data&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;myval&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cool stuff&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;---&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-world-wasi-rust&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;containers&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-world-wasi-rust&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;image&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;webassembly.azurecr.io/hello-world-wasi-rust:v0.1.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;env&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;FOO&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;bar&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;POD_NAME&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;valueFrom&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;fieldRef&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;fieldPath&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;metadata.name&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;CONFIG_MAP_VAL&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;valueFrom&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;configMapKeyRef&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;myval&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-world-wasi-rust&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nodeSelector&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kubernetes.io/arch&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;wasm32-wasi&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;tolerations&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;kubernetes.io/arch&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;operator&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Equal&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;wasm32-wasi&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;effect&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;NoExecute&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;kubernetes.io/arch&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;operator&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Equal&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;wasm32-wasi&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;effect&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;NoSchedule&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;node.kubernetes.io/network-unavailable&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;operator&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Exists&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;effect&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;NoSchedule&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;step-6-run-krustlet-as-a-service&#34;&gt;Step 6: Run Krustlet as a service&lt;/h2&gt;
&lt;p&gt;Create &lt;code&gt;krustlet.service&lt;/code&gt; in &lt;code&gt;/etc/systemd/system/krustlet.service&lt;/code&gt; on the VM.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;[Unit]
Description=Krustlet, a kubelet implementation for running WASM

[Service]
Restart=on-failure
RestartSec=5s
Environment=KUBECONFIG=/etc/krustlet/config/kubeconfig
Environment=NODE_NAME=krustlet
Environment=KRUSTLET_CERT_FILE=/etc/krustlet/config/krustlet.crt
Environment=KRUSTLET_PRIVATE_KEY_FILE=/etc/krustlet/config/krustlet.key
Environment=KRUSTLET_DATA_DIR=/etc/krustlet
Environment=RUST_LOG=wasi_provider=info,main=info
Environment=KRUSTLET_BOOTSTRAP_FILE=/etc/krustlet/config/bootstrap.conf
ExecStart=/usr/local/bin/krustlet-wasi
User=root
Group=root

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ensure that the &lt;code&gt;krustlet.service&lt;/code&gt; has the correct ownership and permissions
with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo chown root:root /etc/systemd/system/krustlet.service
$ sudo chmod 644 /etc/systemd/system/krustlet.service
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo mkdir -p /etc/krustlet/config &amp;amp;&amp;amp; sudo chown -R root:root /etc/krustlet
$ sudo mv {krustlet.*,kubeconfig} /etc/krustlet &amp;amp;&amp;amp; chmod 600 /etc/krustlet/*
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once you have done that, run the following commands to make sure the unit is
configured to start on boot:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ sudo systemctl enable krustlet &amp;amp;&amp;amp; sudo systemctl start krustlet
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;delete-the-vm&#34;&gt;Delete the VM&lt;/h2&gt;
&lt;p&gt;When you are finished with the VM, you can delete it by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud compute instances delete ${INSTANCE} --project=${PROJECT} --zone=${ZONE} --quiet
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When you are finished with the cluster, you can delete it by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ # If you created a regional cluster
$ gcoud container clusters delete ${CLUSTER} --project=${PROJECT} --region=${REGION}
$ # If you created a zonal cluster
$ gcoud container clusters delete ${CLUSTER} --project=${PROJECT} --zone=${ZONE}
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-kind/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-kind/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-kubernetes-in-docker-kind&#34;&gt;Running Krustlet on Kubernetes in Docker (KinD)&lt;/h1&gt;
&lt;p&gt;This how-to guide demonstrates how to boot a Krustlet node in a KinD cluster.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a running KinD cluster for this how-to. &lt;code&gt;kubectl&lt;/code&gt; is also
required. See the &lt;a href=&#34;kubernetes-on-kind.md&#34;&gt;how-to guide for running Kubernetes on
KinD&lt;/a&gt; for more information.&lt;/p&gt;
&lt;p&gt;This specific tutorial will be running Krustlet on your host Operating System;
however, you can follow these steps from any device that can start a web server
on an IP accessible from the Kubernetes control plane, including KinD itself.&lt;/p&gt;
&lt;h2 id=&#34;step-1-get-a-bootstrap-config&#34;&gt;Step 1: Get a bootstrap config&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt; to generate a bootstrap config and then
return to this document. If you already have a kubeconfig available that you
generated through another process, you can proceed to the next step. However,
the credentials Krustlet uses must be part of the &lt;code&gt;system:nodes&lt;/code&gt; group in order
for things to function properly.&lt;/p&gt;
&lt;h2 id=&#34;step-2-determine-the-default-gateway&#34;&gt;Step 2: Determine the default gateway&lt;/h2&gt;
&lt;p&gt;The default gateway for most Docker containers (including your KinD host) is
generally &lt;code&gt;172.17.0.1&lt;/code&gt;. We can use this IP address from the guest Operating
System (the KinD host) to connect to the host Operating System (where Krustlet
is running). If this was changed, check &lt;code&gt;ip addr show docker0&lt;/code&gt; from the host OS
to determine the default gateway.&lt;/p&gt;
&lt;h3 id=&#34;special-note-docker-desktop-for-mac&#34;&gt;Special note: Docker Desktop for Mac&lt;/h3&gt;
&lt;p&gt;For Docker Desktop for Mac users, &lt;a href=&#34;https://docs.docker.com/docker-for-mac/networking/#use-cases-and-workarounds&#34;&gt;the &lt;code&gt;docker0&lt;/code&gt; bridge network is unreachable
from the host
network&lt;/a&gt;
(and vice versa). However, the &lt;code&gt;en0&lt;/code&gt; host network is accessible from within the
container.&lt;/p&gt;
&lt;p&gt;Because the &lt;code&gt;en0&lt;/code&gt; network is the default network, Krustlet will bind to this IP
address automatically. You should not need to pass a &lt;code&gt;--node-ip&lt;/code&gt; flag to
Krustlet.&lt;/p&gt;
&lt;p&gt;In the event this does not appear to be the case (for example, when the hostname
cannot resolve to this address), check which IP address you have for the &lt;code&gt;en0&lt;/code&gt;
network:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ifconfig en0
en0: flags=8863&amp;lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&amp;gt; mtu 1500
        options=400&amp;lt;CHANNEL_IO&amp;gt;
        ether 78:4f:43:8d:4f:55
        inet6 fe80::1c20:1e66:6322:6ae9%en0 prefixlen 64 secured scopeid 0x5
        inet 192.168.1.167 netmask 0xffffff00 broadcast 192.168.1.255
        nd6 options=201&amp;lt;PERFORMNUD,DAD&amp;gt;
        media: autoselect
        status: active
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this example, I should use &lt;code&gt;192.168.1.167&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;special-note-docker-on-hyper-v-linux-vms&#34;&gt;Special note: Docker on Hyper-V Linux VMs&lt;/h3&gt;
&lt;p&gt;For Docker running on a Linux VM on a Windows host under Hyper-V, the default
gateway is usually &lt;code&gt;172.18.0.1&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;step-3-install-and-run-krustlet&#34;&gt;Step 3: Install and run Krustlet&lt;/h2&gt;
&lt;p&gt;First, install the latest release of Krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Once you have done that, run the following commands to run Krustlet&amp;rsquo;s WASI
provider:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;# Since you are running locally, this step is important. Otherwise krustlet will pick up on your
# local config and not be able to update the node status properly
$ export KUBECONFIG=~/.krustlet/config/kubeconfig
$ krustlet-wasi --node-ip 172.17.0.1 --bootstrap-file=~/.krustlet/config/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;step-3a-approving-the-serving-csr&#34;&gt;Step 3a: Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NOTE: You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine&lt;/p&gt;
&lt;p&gt;Then, run &lt;code&gt;kubectl get nodes -o wide&lt;/code&gt; and you should see output that looks
similar to below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes -o wide
NAME                 STATUS   ROLES    AGE     VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE       KERNEL-VERSION     CONTAINER-RUNTIME
kind-control-plane   Ready    master   3m46s   v1.17.0   172.17.0.2    &amp;lt;none&amp;gt;        Ubuntu 19.10   5.3.0-42-generic   containerd://1.3.2
krustlet             Ready    agent    10s     v1.17.0   172.17.0.1    &amp;lt;none&amp;gt;        &amp;lt;unknown&amp;gt;      &amp;lt;unknown&amp;gt;          mvp
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-microk8s/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-microk8s/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-microk8shttpsmicrok8sio&#34;&gt;Running Krustlet on &lt;a href=&#34;https://microk8s.io&#34;&gt;MicroK8s&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;These are steps for running Krustlet node(s) and &lt;a href=&#34;https://microk8s.io&#34;&gt;MicroK8s&lt;/a&gt;
on the same machine.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a running MicroK8s cluster for this guide. The steps below
assume you will run MicroK8s and the Krustlet, on a single machine. &lt;code&gt;kubectl&lt;/code&gt; is
required but is installed with MicroK8s as &lt;code&gt;microk8s.kubectl&lt;/code&gt;. The following
instructions use &lt;code&gt;microk8s.kubectl&lt;/code&gt; for simplicity. You may use a standlone
&lt;code&gt;kubectl&lt;/code&gt; if you prefer.&lt;/p&gt;
&lt;p&gt;In order for the bootstrap authentication token to work, your kube-apiserver
needs to have the &lt;code&gt;--enable-bootstrap-token-auth&lt;/code&gt; feature flag enabled. See
&lt;a href=&#34;https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/&#34;&gt;bootstrap-tokens&lt;/a&gt;
for more information.&lt;/p&gt;
&lt;p&gt;To verify you have the bootstrap authentication feature enabled, check the
process args:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ps -ef | grep kube-apiserver | grep &amp;quot;enable-bootstrap-token-auth&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If it doesn&amp;rsquo;t show up and you installed using &lt;code&gt;snap&lt;/code&gt;, you can find the startup
args in &lt;code&gt;/var/snap/microk8s/current/args/kube-apiserver&lt;/code&gt; and add the flag.&lt;/p&gt;
&lt;p&gt;Now you need to &lt;a href=&#34;https://microk8s.io/docs/configuring-services&#34;&gt;restart&lt;/a&gt; the
kube-apiserver with the command:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ systemctl restart snap.microk8s.daemon-apiserver
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-1-get-a-bootstrap-config&#34;&gt;Step 1: Get a bootstrap config&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt; to generate a bootstrap config and then
return to this document. This will If you already have a kubeconfig available
that you generated through another process, you can proceed to the next step.
However, the credentials Krustlet uses must be part of the &lt;code&gt;system:nodes&lt;/code&gt; group
in order for things to function properly.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; You should now have a file &lt;code&gt;bootstrap.conf&lt;/code&gt; in &lt;code&gt;${HOME}/.krustlet/config&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;step-2-install-and-configure-krustlet&#34;&gt;Step 2: Install and configure Krustlet&lt;/h2&gt;
&lt;p&gt;Install the latest release of Krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s use the built in &lt;code&gt;krustlet-wasi&lt;/code&gt; provider&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ./KUBECONFIG=${PWD}/krustlet-config \
  krustlet-wasi \
  --node-ip=127.0.0.1 \
  --node-name=krustlet \
  --bootstrap-file=${HOME}/.krustlet/config/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: To avoid the Krustlet using your default Kubernetes credentials (&lt;code&gt;~/.kube/config&lt;/code&gt;),
it is a good idea to override the default value here using &lt;code&gt;KUBECONFIG&lt;/code&gt;. For bootstrapping,
&lt;code&gt;KUBECONFIG&lt;/code&gt; must point to a non-existent file (!). Bootstrapping will write a new
configuration file to this location for you.
&lt;strong&gt;NOTE&lt;/strong&gt;: If you receive an error that the CSR already exists, you may safely delete
the existing CSR (&lt;code&gt;kubectl delete csr &amp;lt;hostname&amp;gt;-tls&lt;/code&gt;) and try again.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;step-2a-approving-the-serving-csr&#34;&gt;Step 2a: Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ microk8s.kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;step-3-test-that-things-work&#34;&gt;Step 3: Test that things work&lt;/h2&gt;
&lt;p&gt;Now you can see things work! Feel free to give any of the demos a try in another
terminal like so:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ microk8s.kubectl apply --filename=https://raw.githubusercontent.com/deislabs/krustlet/master/demos/wasi/hello-world-rust/k8s.yaml
$ microk8s.kubectl logs pod/hello-world-wasi-rust
hello from stdout!
hello from stderr!
POD_NAME=hello-world-wasi-rust
FOO=bar
CONFIG_MAP_VAL=cool stuff
Args are: []

Bacon ipsum dolor amet chuck turducken porchetta, tri-tip spare ribs t-bone ham hock. Meatloaf
pork belly leberkas, ham beef pig corned beef boudin ground round meatball alcatra jerky.
Pancetta brisket pastrami, flank pork chop ball tip short loin burgdoggen. Tri-tip kevin
shoulder cow andouille. Prosciutto chislic cupim, short ribs venison jerky beef ribs ham hock
short loin fatback. Bresaola meatloaf capicola pancetta, prosciutto chicken landjaeger andouille
swine kielbasa drumstick cupim tenderloin chuck shank. Flank jowl leberkas turducken ham tongue
beef ribs shankle meatloaf drumstick pork t-bone frankfurter tri-tip.
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-minikube/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-minikube/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-minikube&#34;&gt;Running Krustlet on Minikube&lt;/h1&gt;
&lt;p&gt;This how-to guide demonstrates how to boot a Krustlet node in a Minikube
cluster.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a running Minikube cluster for this how-to. The steps below
assume that minikube was booted with the VirtualBox driver, though other drivers
can be used with some changes. &lt;code&gt;kubectl&lt;/code&gt; is also required.&lt;/p&gt;
&lt;p&gt;See the &lt;a href=&#34;kubernetes-on-minikube.md&#34;&gt;how-to guide for running Kubernetes on
Minikube&lt;/a&gt; for more information.&lt;/p&gt;
&lt;p&gt;This specific tutorial will be running Krustlet on your host Operating System;
however, you can follow these steps from any device that can start a web server
on an IP accessible from the Kubernetes control plane, including Minikube
itself.&lt;/p&gt;
&lt;h2 id=&#34;step-1-get-a-bootstrap-config&#34;&gt;Step 1: Get a bootstrap config&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt; to generate a bootstrap config and then
return to this document. This will If you already have a kubeconfig available
that you generated through another process, you can proceed to the next step.
However, the credentials Krustlet uses must be part of the &lt;code&gt;system:nodes&lt;/code&gt; group
in order for things to function properly.&lt;/p&gt;
&lt;h2 id=&#34;step-2-determine-the-default-gateway&#34;&gt;Step 2: Determine the default gateway&lt;/h2&gt;
&lt;p&gt;The default gateway when you &lt;a href=&#34;kubernetes-on-minikube.md&#34;&gt;set up minikube with the VirtualBox
driver&lt;/a&gt; is generally &lt;code&gt;10.0.2.2&lt;/code&gt;. We can use this IP
address from the guest Operating System (the minikube host) to connect to the
host Operating System (where Krustlet is running). If this was changed, use
&lt;code&gt;minikube ssh&lt;/code&gt; and &lt;code&gt;ip addr show&lt;/code&gt; from the guest OS to determine the default
gateway.&lt;/p&gt;
&lt;h2 id=&#34;step-3-install-and-run-krustlet&#34;&gt;Step 3: Install and run Krustlet&lt;/h2&gt;
&lt;p&gt;First, install the latest release of Krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Once you have done that, run the following commands to run Krustlet&amp;rsquo;s WASI
provider:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;# Since you are running locally, this step is important. Otherwise krustlet will pick up on your
# local config and not be able to update the node status properly
$ export KUBECONFIG=~/.krustlet/config/kubeconfig
$ krustlet-wasi --node-ip 10.0.2.2 --bootstrap-file=~/.krustlet/config/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;step-3a-approving-the-serving-csr&#34;&gt;Step 3a: Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NOTE: You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine&lt;/p&gt;
&lt;p&gt;In another terminal, run &lt;code&gt;kubectl get nodes -o wide&lt;/code&gt; and you should see output
that looks similar to below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes -o wide
NAME       STATUS   ROLES    AGE   VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE               KERNEL-VERSION   CONTAINER-RUNTIME
minikube   Ready    master   18m   v1.18.0   192.168.99.165   &amp;lt;none&amp;gt;        Buildroot 2019.02.10   4.19.107         docker://19.3.8
krustlet   Ready    agent    9s    v1.17.0   10.0.2.2         &amp;lt;none&amp;gt;        &amp;lt;unknown&amp;gt;              &amp;lt;unknown&amp;gt;        mvp
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-on-wsl2/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-on-wsl2/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-wsl2-with-docker-desktop&#34;&gt;Running Krustlet on WSL2 with Docker Desktop&lt;/h1&gt;
&lt;p&gt;This how-to guide demonstrates how to boot a Krustlet node in Docker Desktop for
Windows with WSL2 backend.&lt;/p&gt;
&lt;h2 id=&#34;information&#34;&gt;Information&lt;/h2&gt;
&lt;p&gt;This tutorial will work on current Windows 10 Insider Slow ring and Docker
Desktop for Windows stable release.&lt;/p&gt;
&lt;p&gt;This tutorial will work on current Windows 10 Insider Slow ring and Docker
Desktop for Windows stable release.&lt;/p&gt;
&lt;p&gt;Concerning Windows, this tutorial should work on the Production ring once it
will be available.&lt;/p&gt;
&lt;p&gt;Last but not least, this will work on Windows 10 Home edition.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You will require a WSL2 distro and Docker Desktop for Windows for this how-to.
The WSL2 backend and Kubernetes features will need to be also enabled. See the
&lt;a href=&#34;https://docs.docker.com/docker-for-windows/#kubernetes&#34;&gt;Docker Desktop for Windows &amp;gt; Getting started &amp;gt;
Kubernetes&lt;/a&gt; howto for
more information.&lt;/p&gt;
&lt;p&gt;This specific tutorial will be running Krustlet on your WSL2 distro and will
explain how to access it from Windows.&lt;/p&gt;
&lt;h2 id=&#34;step-1-determine-the-default-gateway&#34;&gt;Step 1: Determine the default gateway&lt;/h2&gt;
&lt;p&gt;The default gateway for most Docker containers is generally &lt;code&gt;172.17.0.1&lt;/code&gt;. This
IP is only reachable, by default, from the WSL2 distro. However, the &lt;code&gt;eth0&lt;/code&gt; host
network is accessible from Windows, so we can use this IP address to connect to
the WSL2 distro (where Krustlet is running).&lt;/p&gt;
&lt;p&gt;If this was changed, check &lt;code&gt;ifconfig eth0&lt;/code&gt; from the host OS to determine the
default gateway:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ifconfig eth0
eth0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt;  mtu 1500
        inet 172.26.47.208  netmask 255.255.240.0  broadcast 172.26.47.255
        inet6 fe80::215:5dff:fe98:ce48  prefixlen 64  scopeid 0x20&amp;lt;link&amp;gt;
        ether 00:15:5d:98:ce:48  txqueuelen 1000  (Ethernet)
        RX packets 16818  bytes 11576089 (11.0 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1093  bytes 115724 (113.0 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this example, I should use &lt;code&gt;172.26.47.208&lt;/code&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TIP: get the IP from &lt;code&gt;eth0&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ export mainIP=$(ifconfig eth0 | grep &amp;quot;inet &amp;quot; | awk &#39;{ print $2 }&#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The hostname being &amp;ldquo;applied&amp;rdquo; from Windows, the default hostname will not resolve
to this address, therefore you need to pass the &lt;code&gt;--node-ip&lt;/code&gt; and &lt;code&gt;--node-name&lt;/code&gt;
flag to Krustlet.&lt;/p&gt;
&lt;h2 id=&#34;step-2-get-a-bootstrap-config&#34;&gt;Step 2: Get a bootstrap config&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt; to generate a bootstrap config and then
return to this document. This will If you already have a kubeconfig available
that you generated through another process, you can proceed to the next step.
However, the credentials Krustlet uses must be part of the &lt;code&gt;system:nodes&lt;/code&gt; group
in order for things to function properly.&lt;/p&gt;
&lt;h2 id=&#34;step-3-install-and-run-krustlet&#34;&gt;Step 3: Install and run Krustlet&lt;/h2&gt;
&lt;p&gt;First, install the latest release of Krustlet following &lt;a href=&#34;../intro/install.md&#34;&gt;the install
guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Second, ensure the Kubernetes context is correctly set to &lt;code&gt;docker-desktop&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl config get-contexts
CURRENT   NAME                 CLUSTER          AUTHINFO         NAMESPACE
*         docker-desktop       docker-desktop   docker-desktop

# Optional if the context is not set correctly
$ kubectl config set-context docker-desktop
Context &amp;quot;docker-desktop&amp;quot; modified.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once you have done that, run the following commands to run Krustlet&amp;rsquo;s WASI
provider:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;# Since you are running locally, this step is important. Otherwise krustlet will pick up on your
# local config and not be able to update the node status properly
$ export KUBECONFIG=~/.krustlet/config/kubeconfig
$ krustlet-wasi --node-ip $mainIP --node-name krustlet --bootstrap-file=~/.krustlet/config/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;step-3a-approving-the-serving-csr&#34;&gt;Step 3a: Approving the serving CSR&lt;/h3&gt;
&lt;p&gt;Once you have started Krustlet, there is one more manual step (though this could
be automated depending on your setup) to perform. The client certs Krustlet
needs are generally approved automatically by the API. However, the serving
certs require manual approval. To do this, you&amp;rsquo;ll need the hostname you
specified for the &lt;code&gt;--hostname&lt;/code&gt; flag or the output of &lt;code&gt;hostname&lt;/code&gt; if you didn&amp;rsquo;t
specify anything. From another terminal that&amp;rsquo;s configured to access the cluster,
run:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl certificate approve &amp;lt;hostname&amp;gt;-tls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NOTE: You will only need to do this approval step the first time Krustlet
starts. It will generate and save all of the needed credentials to your machine&lt;/p&gt;
&lt;p&gt;In another terminal, run &lt;code&gt;kubectl get nodes -o wide&lt;/code&gt; and you should see output
that looks similar to below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes -o wide
NAME             STATUS   ROLES    AGE     VERSION   INTERNAL-IP     EXTERNAL-IP   OS-IMAGE         KERNEL-VERSION                CONTAINER-RUNTIME
docker-desktop   Ready    master   3d23h   v1.15.5   192.168.65.3    &amp;lt;none&amp;gt;        Docker Desktop   4.19.104-microsoft-standard   docker://19.3.8
krustlet      Ready    agent    34s     v1.17.0   172.26.47.208   &amp;lt;none&amp;gt;        &amp;lt;unknown&amp;gt;        &amp;lt;unknown&amp;gt;                     mvp
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;optional-delete-the-krustlet-node&#34;&gt;Optional: Delete the Krustlet node&lt;/h2&gt;
&lt;p&gt;Once you will no more need the Krustlet node, you can remove it from your
cluster with the following &lt;code&gt;kubectl delete node&lt;/code&gt; command:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl delete node krustlet
node &amp;quot;krustlet&amp;quot; deleted

$ kubectl get nodes -o wide
NAME             STATUS   ROLES    AGE   VERSION   INTERNAL-IP    EXTERNAL-IP   OS-IMAGE         KERNEL-VERSION                CONTAINER-RUNTIME
docker-desktop   Ready    master   4d    v1.15.5   192.168.65.3   &amp;lt;none&amp;gt;        Docker Desktop   4.19.104-microsoft-standard   docker://19.3.8
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;troubleshooting&#34;&gt;Troubleshooting&lt;/h2&gt;
&lt;h3 id=&#34;wasm-workloads-on-docker-desktop&#34;&gt;WASM workloads on Docker Desktop&lt;/h3&gt;
&lt;p&gt;Docker Desktop&amp;rsquo;s Kubernetes always provides a schedulable node called
&lt;code&gt;docker-desktop&lt;/code&gt;. This node uses Docker to run containers. If you want to run
WASM workloads on Krustlet, you must prevent these pods from being scheduled to
the &lt;code&gt;docker-desktop&lt;/code&gt; node. You can do this using a nodeSelector in pod specs.
See &lt;a href=&#34;../howto/wasm.md&#34;&gt;Running WASM workloads&lt;/a&gt; for details.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/krustlet-with-inlets/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/krustlet-with-inlets/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-krustlet-on-kubernetes-with-inlets&#34;&gt;Running Krustlet on Kubernetes with inlets&lt;/h1&gt;
&lt;p&gt;These are steps for running a krustlet node on your own computer. You can run
any kind of Kubernetes cluster you like, whether that&amp;rsquo;s local on your computer
or remote in a managed Kubernetes offering.&lt;/p&gt;
&lt;p&gt;The instructions provided in this guide were contributed by &lt;a href=&#34;https://github.com/alexellis&#34;&gt;Alex
Ellis&lt;/a&gt;. For support with the instructions, see the
&lt;a href=&#34;https://slack.openfaas.io/&#34;&gt;#inlets channel of OpenFaaS Slack&lt;/a&gt; or raise a
GitHub issue and tag &lt;code&gt;@alexellis&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;There are a number of ways to give the Kubernetes API server access to the
krustlet&amp;rsquo;s API. Various methods include using a VPN, a VM within the Kubernetes
cluster&amp;rsquo;s private network, or a tunnel. &lt;a href=&#34;https://docs.inlets.dev/&#34;&gt;Inlets&lt;/a&gt; is a
popular open source service tunnel and proxy. It can be used to forward the port
of the krustlet to the Kubernetes cluster so that the Kubernetes API server can
access it as if it were deployed within the cluster directly.&lt;/p&gt;
&lt;p&gt;The tunnel has two components: A client which runs on your local machine, and a
server which is deployed as a Pod inside the Kubernetes cluster. The client
connects to the server and provides a persistent link.&lt;/p&gt;
&lt;p&gt;Download the latest release of the inlets binary from the &lt;a href=&#34;https://github.com/inlets/inlets/releases&#34;&gt;project release
page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Move the binary to &lt;code&gt;/usr/local/bin&lt;/code&gt;, or place it somewhere on your &lt;code&gt;$PATH&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;step-1-get-a-bootstrap-config&#34;&gt;Step 1: Get a bootstrap config&lt;/h2&gt;
&lt;p&gt;Krustlet requires a bootstrap token and config the first time it runs. Follow
the guide &lt;a href=&#34;bootstrapping.md&#34;&gt;here&lt;/a&gt; to generate a bootstrap config and then
return to this document. This will If you already have a kubeconfig available
that you generated through another process, you can proceed to the next step.
However, the credentials Krustlet uses must be part of the &lt;code&gt;system:nodes&lt;/code&gt; group
in order for things to function properly.&lt;/p&gt;
&lt;h2 id=&#34;step-2-create-the-inlets-service&#34;&gt;Step 2: Create the inlets service&lt;/h2&gt;
&lt;p&gt;In order to start Krustlet with the correct node IP address, you&amp;rsquo;ll need to
create the &lt;code&gt;inlets&lt;/code&gt; service in Kubernetes like so:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;cat &amp;lt;&amp;lt;EOF | kubectl apply -f -
apiVersion: v1
kind: Service
metadata:
  name: inlets
  labels:
    app: inlets
spec:
  type: ClusterIP
  ports:
    - port: 8000
      protocol: TCP
      targetPort: 8000
      name: control
    - port: 3000
      protocol: TCP
      targetPort: 3000
      name: data
  selector:
    app: inlets
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Once it has been created, run the following command to have the node IP
available for next steps. This is a stable IP and won&amp;rsquo;t change.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;export NODE_IP=$(kubectl get service inlets -o jsonpath=&amp;quot;{.spec.clusterIP}&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-3-run-krustlet&#34;&gt;Step 3: Run &lt;code&gt;krustlet&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;You&amp;rsquo;ll need the certificates generated from the bootstrap process for our next
steps, so go ahead and start krustlet:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;# Since you are running locally, this step is important. Otherwise krustlet will pick up on your
# local config and not be able to update the node status properly
export KUBECONFIG=~/.krustlet/config/kubeconfig
krustlet-wasi --node-ip $NODE_IP --bootstrap-file=~/.krustlet/config/bootstrap.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then open another terminal for the next steps.&lt;/p&gt;
&lt;h2 id=&#34;step-4-setup-inlets-server&#34;&gt;Step 4: Setup inlets server&lt;/h2&gt;
&lt;p&gt;Create a Kubernetes secret for the inlets server:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;export TOKEN=$(head -c 16 /dev/urandom |shasum|cut -d- -f1)
echo $TOKEN &amp;gt; token.txt

kubectl create secret generic inlets-token --from-literal token=${TOKEN}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then, create a Kubernetes secret for krustlet&amp;rsquo;s TLS certificates. These will be
used by the inlets server so that the kubelet can access the tunnel using the
expected TLS certificates.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;kubectl create secret ghosttunnel-tls generic \
  --from-file tls.crt=~/.krustlet/config/krustlet.crt \
  --from-file tls.key=~/.krustlet/config/krustlet.key
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The inlets OSS version exposes services with HTTP within the cluster, so this
example uses &lt;code&gt;ghosttunnel&lt;/code&gt; as a tiny reverse proxy to mount the krustlet&amp;rsquo;s TLS
certificates so that the kubelet gets a valid HTTPS response. The service
created before will expose it to the cluster&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;$ cat &amp;lt;&amp;lt;EOF | kubectl apply -f -&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;apps/v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Deployment&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;replicas&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;selector&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;matchLabels&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;app&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;template&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;labels&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;app&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumes&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ghosttunnel-tls-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;secret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;secretName&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ghosttunnel-tls&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets-token-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;secret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;secretName&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets-token&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;containers&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;image&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets/inlets:2.7.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Always&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;command&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;inlets&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;server&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--token-from=/var/inlets/token&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--control-port=8000&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--port=3001&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumeMounts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;inlets-token-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;mountPath&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;/var/inlets/&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ghosttunnel&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;image&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;squareup/ghostunnel:v1.5.2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Always&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;args&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;server&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--target=127.0.0.1:3001&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--listen=0.0.0.0:3000&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--cert=/etc/tls/tls.crt&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--key=/etc/tls/tls.key&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;- &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;--disable-authentication&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;volumeMounts&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ghosttunnel-tls-volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;mountPath&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;/etc/tls&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;EOF&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;step-5-run-the-inlets-client&#34;&gt;Step 5: Run the inlets client&lt;/h2&gt;
&lt;p&gt;Port-forward or expose the inlets server with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;kubectl port-forward svc/inlets 8000:8000 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You can also expose inlets via Ingress using cert-manager to give its
control-port a TLS certificate.&lt;/p&gt;
&lt;p&gt;Run the &lt;code&gt;inlets client&lt;/code&gt; on your computer:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;inlets client \
  --upstream https://127.0.0.1:3000 \
  --remote ws://127.0.0.1:8000 --token $(token.txt)
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;step-6-verify-the-node-is-available&#34;&gt;Step 6: Verify the node is available&lt;/h2&gt;
&lt;p&gt;Show that the krustlet node has joined the cluster:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes -o wide
NAME                   STATUS   ROLES    AGE    VERSION   INTERNAL-IP      EXTERNAL-IP       OS-IMAGE                       KERNEL-VERSION         CONTAINER-RUNTIME
pool-3xbltttyc-3no2p   Ready    &amp;lt;none&amp;gt;   153m   v1.16.6   10.131.25.141    206.189.19.185    Debian GNU/Linux 9 (stretch)   4.19.0-0.bpo.6-amd64   docker://18.9.2
pool-3xbltttyc-3no2s   Ready    &amp;lt;none&amp;gt;   153m   v1.16.6   10.131.28.223    206.189.123.184   Debian GNU/Linux 9 (stretch)   4.19.0-0.bpo.6-amd64   docker://18.9.2
krustlet               Ready    agent    43m    v1.17.0   10.245.157.226   &amp;lt;none&amp;gt;            &amp;lt;unknown&amp;gt;                      &amp;lt;unknown&amp;gt;              mvp
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;appendix&#34;&gt;Appendix&lt;/h2&gt;
&lt;h3 id=&#34;remove-the-port-forward-for-inlets-osshttpsdocsinletsdev&#34;&gt;Remove the port-forward for &lt;a href=&#34;https://docs.inlets.dev&#34;&gt;inlets OSS&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We are using a port-forward to make it easier to use the tutorial. For permanent
use, you will want to expose the inlets server and its control port directly.
The OSS version can be configured with TLS, but this is not built-in.&lt;/p&gt;
&lt;p&gt;You can set up an Ingress rule for the control-port of the inlets server (port
8000), and obtain a TLS certificate from LetsEncrypt.&lt;/p&gt;
&lt;h3 id=&#34;use-inlets-pro-instead&#34;&gt;Use inlets PRO instead&lt;/h3&gt;
&lt;p&gt;Inlets OSS is an L7 proxy that requires additional work to configure for
krustlet. inlets PRO is a pure L4 TCP proxy with built-in TLS for the
control-plane.&lt;/p&gt;
&lt;p&gt;With &lt;a href=&#34;https://github.com/inlets/inlets-pro&#34;&gt;inlets PRO&lt;/a&gt; you can expose the
control port (8123) directly to the Internet as a NodePort, or LoadBalancer, or
if you wish via an Ingress definition. The control port already has TLS
configured, so won&amp;rsquo;t need additional link-layer encryption.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/kubernetes-on-do/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/kubernetes-on-do/</guid>
      <description>
        
        
        &lt;h1 id=&#34;managed-kubernetes-on-digitalocean&#34;&gt;Managed Kubernetes on DigitalOcean&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://www.digitalocean.com/products/kubernetes/&#34;&gt;Managed Kubernetes on DigitalOcean&lt;/a&gt;
is an inexpensive, professionally-managed Kubernetes service.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll need a DigitalOcean account and will need to have provided a payment method.
DigitalOcean offers a &lt;a href=&#34;https://try.digitalocean.com/freetrialoffer&#34;&gt;free trial&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You may provision Kubernetes clusters and Droplets (DigitalOcean VMs) using the
&lt;a href=&#34;https://cloud.digitalocean.com&#34;&gt;console&lt;/a&gt; but DigitalOcean&amp;rsquo;s CLI &lt;a href=&#34;https://github.com/digitalocean/doctl&#34;&gt;doctl&lt;/a&gt;
is comprehensive and recommended. The instructions that follow assume you&amp;rsquo;ve
installed doctl and &lt;a href=&#34;https://github.com/digitalocean/doctl#authenticating-with-digitalocean&#34;&gt;authenticated&lt;/a&gt;
to a DigitalOcean account.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; If you use the doctl &lt;a href=&#34;https://github.com/digitalocean/doctl#snap-supported-os&#34;&gt;Snap&lt;/a&gt;,
consider connecting &lt;a href=&#34;https://github.com/digitalocean/doctl#use-with-kubectl&#34;&gt;kubectl&lt;/a&gt;
and &lt;a href=&#34;https://github.com/digitalocean/doctl#using-doctl-compute-ssh&#34;&gt;ssh-keys&lt;/a&gt; to
simplify the experience.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;create-managed-kubernetes-cluster&#34;&gt;Create Managed Kubernetes cluster&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;doctl kubernetes&lt;/code&gt; includes commands for provisioning clusters. In order to create
a cluster, you&amp;rsquo;ll need to provide a Kubernetes version, a node instance size, a
DigitalOcean region and the number of nodes. Values for some of the values may
be obtained using the following &lt;code&gt;doctl kubernetes&lt;/code&gt; commands:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl kubernetes options versions
$ doctl kubernetes options regions
$ doctl kubernetes options sizes
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; DigitalOcean uses unique identifiers called &amp;ldquo;slugs&amp;rdquo;. &amp;ldquo;slugs&amp;rdquo; are the
identifiers used as values in many of &lt;code&gt;doctl&lt;/code&gt;&amp;rsquo;s commands, e.g. &lt;code&gt;1.19.3-do.3&lt;/code&gt; is
the slug for Kubernetes version &lt;code&gt;1.19.3&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you&amp;rsquo;d prefer to use some reasonable default values, you may use the following
command to create a cluster in DigitalOcean&amp;rsquo;s San Francisco region, using
Kubernetes &lt;code&gt;1.19.3&lt;/code&gt; with a single worker node (the master node is free). The
worker node has 1 vCPU and 2GB RAM (currently $10/month).&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ CLUSTER=[[YOUR-CLUSTER-NAME]]
$ VERSION=&amp;quot;1.19.3-do.3&amp;quot;
$ SIZE=&amp;quot;s-1vcpu-2gb&amp;quot;
$ REGION=&amp;quot;sfo3&amp;quot;

$ doctl kubernetes cluster create ${CLUSTER} \
  --auto-upgrade \
  --count 1 \
  --version ${VERSION} \
  --size ${SIZE} \
  --region ${REGION}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;doctl kubernetes cluster create&lt;/code&gt; should automatically update your default
Kubernetes config (Linux: &lt;code&gt;${HOME}/.kube/config&lt;/code&gt;). &lt;code&gt;doctl kubernetes cluster delete&lt;/code&gt;
will remove this entry when it deletes the cluster. You should be able to:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                            STATUS   ROLES    AGE   VERSION
${CLUSTER}-default-pool-39yh5   Ready    &amp;lt;none&amp;gt;   1m    v1.19.3
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;delete-managed-kubernetes-cluster&#34;&gt;Delete Managed Kubernetes cluster&lt;/h2&gt;
&lt;p&gt;When you are finished with the cluster, you may delete it with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl kubernetes cluster delete ${CLUSTER}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; This command should (!) delete the cluster&amp;rsquo;s entries (context, user)
from the default Kubernetes config (Linux `{$HOME}/.kube/config) too.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To confirm that the cluster has been deleted, if you try listing the clusters,
the cluster you deleted should no longer be present:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl kubernetes cluster list
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Or you may confirm that the Droplets have been deleted:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ doctl compute droplet list
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/kubernetes-on-gke/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/kubernetes-on-gke/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-kubernetes-on-google-kubernetes-engine-gke&#34;&gt;Running Kubernetes on Google Kubernetes Engine (GKE)&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://cloud.google.com/kubernetes-engine&#34;&gt;Google Kubernetes Engine (GKE)&lt;/a&gt; is
a secured and managed Kubernetes service.&lt;/p&gt;
&lt;p&gt;If you haven&amp;rsquo;t used Google Cloud Platform, you&amp;rsquo;ll need a Google (e.g. Gmail)
account. As a new customer, you may benefit from $300 free credit. Google Cloud
Platform includes always free products. See &lt;a href=&#34;https://cloud.google.com/free&#34;&gt;Google Cloud Platform Free
Tier&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;You should be able to run &lt;a href=&#34;https://cloud.google.com/sdk&#34;&gt;Google Cloud SDK&lt;/a&gt;
command-line tool &lt;code&gt;gcloud&lt;/code&gt;. This is used to provision resources in Google Cloud
Platform including Kubernetes clusters.&lt;/p&gt;
&lt;p&gt;Either install &lt;a href=&#34;https://cloud.google.com/sdk/install&#34;&gt;Google Cloud SDK&lt;/a&gt; or open
a &lt;a href=&#34;https://console.cloud.google.com/home/dashboard?cloudshell=true&#34;&gt;Cloud
Shell&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Google Cloud SDK is available for Linux, Windows and Mac OS. The instructions
that follow document using the command-line on Linux. There may be subtle
changes for Windows and Mac OS.&lt;/p&gt;
&lt;p&gt;Google Cloud Platform provides a browser-based
&lt;a href=&#34;https://console.cloud.google.com&#34;&gt;Console&lt;/a&gt;. This is generally functionally
equivalent to the command-line tool. The instructions that follow document using
the command-line tool but you may perform these steps using the Console too.&lt;/p&gt;
&lt;p&gt;You will also need Kubernetes command-line tool &lt;code&gt;kubectl&lt;/code&gt;. &lt;code&gt;kubectl&lt;/code&gt; is used by
all Kubernetes distributions. So, if you&amp;rsquo;ve created Kubernetes clusters locally
or on other cloud platforms, you may already have this tool installed. See
&lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/install-kubectl/&#34;&gt;Install and Set Up
kubectl&lt;/a&gt; for
instructions.&lt;/p&gt;
&lt;h2 id=&#34;configure-google-cloud-cli&#34;&gt;Configure Google Cloud CLI&lt;/h2&gt;
&lt;p&gt;After installing Google Cloud SDK, you will need to initialize the tool. This
also authenticates your account using a Google identity (e.g. Gmail). Do this by
typing &lt;code&gt;gcloud init&lt;/code&gt;. If for any reason, you have already run &lt;code&gt;gcloud init&lt;/code&gt;, you
may reauthenticate using &lt;code&gt;gcloud auth login&lt;/code&gt; or check authentication with
&lt;code&gt;gcloud auth list&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&#34;create-gke-cluster&#34;&gt;Create GKE cluster&lt;/h2&gt;
&lt;p&gt;Google Cloud Platform resources are aggregated by projects. Projects are
assigned to Billing Accounts. GKE uses Compute Engine VMs as nodes and Compute
Engine VMs require that assign a Billing Account to our project so that we may
pay for the VMs.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ PROJECT=[YOUR-PROJECT] # Perhaps $(whoami)-$(date +%y%m%d)-krustlet
$ BILLING=[YOUR-BILLING] # You may list these using `gcloud beta billing accounts list`
$ # Create Project and assing Billing Account
$ gcloud projects create ${PROJECT}
$ gcloud alpha billing projects link ${PROJECT} --billing-account=${BILLING}
$ # Enable Kubernetes Engine &amp;amp; Compute Engine
$ gcloud services enable container.googleapis.com --project=${PROJECT}
$ gcloud services enable compute.googleapis.com --project=${PROJECT}
$ REGION=&amp;quot;us-west1&amp;quot; # Use a region close to you `gcloud compute regions list --project=${PROJECT}`
$ CLUSTER=&amp;quot;cluster&amp;quot;
$ # Create GKE cluster with 3 nodes (one per zone in the region)
$ gcloud beta container clusters create ${CLUSTER} \
--project=${PROJECT} \
--region=${REGION} \
--no-enable-basic-auth \
--release-channel &amp;quot;rapid&amp;quot; \
--machine-type &amp;quot;n1-standard-1&amp;quot; \
--image-type &amp;quot;COS_CONTAINERD&amp;quot; \
--preemptible \
--num-nodes=&amp;quot;1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; This creates a cluster with nodes distributed across multiple zones
in a region. This increases the cluster&amp;rsquo;s availability. If you&amp;rsquo;d prefer a less
available (and cheaper) single zone cluster, you may use the following commands
instead:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ ZONE=&amp;quot;${REGION}-a&amp;quot; # Or &amp;quot;-b&amp;quot; or &amp;quot;-c&amp;quot;
$ gcloud beta container clusters create ${CLUSTER} \
--project=${PROJECT} \
--zone=${ZONE} \
--no-enable-basic-auth \
--release-channel &amp;quot;rapid&amp;quot; \
--machine-type &amp;quot;n1-standard-1&amp;quot; \
--image-type &amp;quot;COS_CONTAINERD&amp;quot; \
--preemptible \
--num-nodes=&amp;quot;1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After a minute, you should see the cluster created:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;NAME     LOCATION  MASTER_VERSION  MASTER_IP       MACHINE_TYPE   NODE_VERSION   NUM_NODES  STATUS
cluster  us-west1  1.17.4-gke.10   xx.xx.xx.xx     n1-standard-1  1.17.4-gke.10  3          RUNNING
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; You may also use Cloud Console to interact with the cluster:
&lt;a href=&#34;https://console.cloud.google.com/&#34;&gt;https://console.cloud.google.com/&lt;/a&gt; &lt;strong&gt;NOTE&lt;/strong&gt; &lt;code&gt;gcloud clusters create&lt;/code&gt; also
configures &lt;code&gt;kubectl&lt;/code&gt; to be able to access the cluster.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You may confirm access to the cluster by typing:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl get nodes
NAME                                     STATUS   ROLES    AGE   VERSION
gke-cluster-default-pool-1a3a5b85-scds   Ready    &amp;lt;none&amp;gt;   10m   v1.17.4-gke.10
gke-cluster-default-pool-3885c0e3-6zw2   Ready    &amp;lt;none&amp;gt;   10m   v1.17.4-gke.10
gke-cluster-default-pool-6d70a85d-19r8   Ready    &amp;lt;none&amp;gt;   10m   v1.17.4-gke.10
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You may confirm the Kubernetes configuration either by:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ more ${HOME}/.kube/config
apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: LS0tLS1C...
    server: https://xx.xx.xx.xx
  name: gke_${PROJECT}_${REGION}_${CLUSTER}
contexts:
- context:
    cluster: gke_${PROJECT}_${REGION}_${CLUSTER}
    user: gke_${PROJECT}_${REGION}_${CLUSTER}
  name: gke_${PROJECT}_${REGION}_${CLUSTER}
current-context: gke_${PROJECT}_${REGION}_${CLUSTER}
kind: Config
preferences: {}
users:
- name: gke_${PROJECT}_${REGION}_${CLUSTER}
  user:
    auth-provider:
      config:
        cmd-args: config config-helper --format=json
        cmd-path: /snap/google-cloud-sdk/130/bin/gcloud
        expiry-key: &#39;{.credential.token_expiry}&#39;
        token-key: &#39;{.credential.access_token}&#39;
      name: gcp
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Or:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl config current-context
gke_${PROJECT}_${REGION}_${CLUSTER}
$ kubectl config get-contexts
CURRENT   NAME                                  CLUSTER                               AUTHINFO
*         gke_${PROJECT}_${REGION}_${CLUSTER}   gke_${PROJECT}_${REGION}_${CLUSTER}   gke_${PROJECT}_${REGION}_${CLUSTER}
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;delete-the-cluster&#34;&gt;Delete the Cluster&lt;/h2&gt;
&lt;p&gt;When you are finished with the cluster, you may delete it with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud beta container clusters delete ${CLUSTER} --project=${PROJECT} --region=${REGION} --quiet
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If you wish to delete everything in the project, you may delete hte project
(including all its resources) with:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ gcloud projects delete ${PROJECT} --quiet
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt; Both commands are irrevocable.&lt;/p&gt;
&lt;/blockquote&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/kubernetes-on-kind/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/kubernetes-on-kind/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-kubernetes-on-kubernetes-in-docker-kind&#34;&gt;Running Kubernetes on Kubernetes in Docker (KinD)&lt;/h1&gt;
&lt;p&gt;This tutorial will focus on using a tool called &lt;a href=&#34;https://github.com/kubernetes-sigs/kind&#34;&gt;kind&lt;/a&gt;,
also known as &amp;ldquo;Kubernetes IN Docker&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;If you haven&amp;rsquo;t installed them already, go ahead and &lt;a href=&#34;https://docs.docker.com/install/&#34;&gt;install
Docker&lt;/a&gt;, &lt;a href=&#34;https://github.com/kubernetes-sigs/kind#installation-and-usage&#34;&gt;install
kind&lt;/a&gt;, and &lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/install-kubectl/&#34;&gt;install
kubectl&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll need &lt;code&gt;kubectl&lt;/code&gt; to interact with the cluster once it&amp;rsquo;s created.&lt;/p&gt;
&lt;h2 id=&#34;create-a-cluster&#34;&gt;Create a cluster&lt;/h2&gt;
&lt;p&gt;Once Docker, kind, and kubectl are installed, create a cluster with kind:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kind create cluster
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This will create a cluster with a single node - perfect for local development.&lt;/p&gt;
&lt;p&gt;You should see output similar to the following:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;Creating cluster &amp;quot;kind&amp;quot; ...
 ✓ Ensuring node image (kindest/node:v1.17.0) 🖼
 ✓ Preparing nodes 📦
 ✓ Writing configuration 📜
 ✓ Starting control-plane 🕹️
 ✓ Installing CNI 🔌
 ✓ Installing StorageClass 💾
Set kubectl context to &amp;quot;kind-kind&amp;quot;
You can now use your cluster with:

kubectl cluster-info --context kind-kind

Have a nice day! 👋
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now we can interact with our cluster! Try that out now:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl cluster-info
Kubernetes master is running at https://127.0.0.1:32768
KubeDNS is running at https://127.0.0.1:32768/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To further debug and diagnose cluster problems, use &amp;lsquo;kubectl cluster-info dump&amp;rsquo;.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/kubernetes-on-minikube/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/kubernetes-on-minikube/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-kubernetes-on-minikube&#34;&gt;Running Kubernetes on Minikube&lt;/h1&gt;
&lt;p&gt;This tutorial will focus on using a tool called
&lt;a href=&#34;https://github.com/kubernetes/minikube&#34;&gt;minikube&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you haven&amp;rsquo;t installed them already, go ahead and &lt;a href=&#34;https://www.virtualbox.org/&#34;&gt;install VirtualBox 5.2 or
higher&lt;/a&gt;, &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/linux/&#34;&gt;install
minikube&lt;/a&gt;, and &lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/install-kubectl/&#34;&gt;install
kubectl&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll need &lt;code&gt;kubectl&lt;/code&gt; to interact with the cluster once it&amp;rsquo;s created.&lt;/p&gt;
&lt;h2 id=&#34;check-virtualization-support&#34;&gt;Check virtualization support&lt;/h2&gt;
&lt;p&gt;To use VM drivers, verify that your system has virtualization support enabled:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ egrep -q &#39;vmx|svm&#39; /proc/cpuinfo &amp;amp;&amp;amp; echo yes || echo no
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the above command outputs “no”:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If you are running within a VM, your hypervisor does not allow nested
virtualization. You will need to use the &lt;em&gt;None (bare-metal)&lt;/em&gt; driver&lt;/li&gt;
&lt;li&gt;If you are running on a physical machine, ensure that your BIOS has hardware
virtualization enabled&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;create-a-cluster&#34;&gt;Create a cluster&lt;/h2&gt;
&lt;p&gt;Once VirtualBox, minikube, and kubectl are installed, create a cluster with
minikube:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ minikube start --driver=virtualbox
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This will create a cluster with a single node - perfect for local development.&lt;/p&gt;
&lt;p&gt;You should see output similar to the following:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;😄  minikube v1.9.0 on Ubuntu 18.04
✨  Using the virtualbox driver based on user configuration
💿  Downloading VM boot image ...
💾  Downloading Kubernetes v1.18.0 preload ...
🔥  Creating virtualbox VM (CPUs=2, Memory=6000MB, Disk=20000MB) ...
🐳  Preparing Kubernetes v1.18.0 on Docker 19.03.8 ...
🌟  Enabling addons: default-storageclass, storage-provisioner
🏄  Done! kubectl is now configured to use &amp;quot;minikube&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now we can interact with our cluster! Try that out now:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;$ kubectl cluster-info
Kubernetes master is running at https://192.168.99.164:8443
KubeDNS is running at https://192.168.99.164:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To further debug and diagnose cluster problems, use &amp;lsquo;kubectl cluster-info dump&amp;rsquo;.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>En: </title>
      <link>https://docs.krustlet.dev/en/howto/wasm/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://docs.krustlet.dev/en/howto/wasm/</guid>
      <description>
        
        
        &lt;h1 id=&#34;running-web-assembly-wasm-workloads-in-kubernetes&#34;&gt;Running Web Assembly (WASM) workloads in Kubernetes&lt;/h1&gt;
&lt;p&gt;The Krustlet repository contains the built-in &lt;code&gt;krustlet-wasi&lt;/code&gt; provider for
running WASM workloads in Kubernetes. There is also a &lt;code&gt;krustlet-wasmcloud&lt;/code&gt;
&lt;a href=&#34;https://github.com/wasmCloud/krustlet-wasmcloud-provider&#34;&gt;provider&lt;/a&gt; available
that also runs WASM workloads. These kubelets run workloads implemented as Web
Assembly (WASM) modules rather than as OCI containers. Each running instance
appears to Kubernetes as a node; Kubernetes schedules work to the instance as to
any other node.&lt;/p&gt;
&lt;h2 id=&#34;running-wasm-modules-on-the-right-kubelet&#34;&gt;Running WASM modules on the right kubelet&lt;/h2&gt;
&lt;p&gt;WASM modules are not interchangeable with OCI containers: &lt;code&gt;krustlet-wasi&lt;/code&gt; and
&lt;code&gt;krustlet-wasmcloud&lt;/code&gt; can&amp;rsquo;t run OCI containers, and normal OCI nodes can&amp;rsquo;t run WASM
modules. In order to run your WASM workloads on the right nodes, you should use
the Kubernetes tolerations system; in some cases you will also need to use node
affinity.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;krustlet-wasi&lt;/code&gt; and &lt;code&gt;krustlet-wasmcloud&lt;/code&gt; &amp;lsquo;virtual nodes&amp;rsquo; both have &lt;code&gt;NoExecute&lt;/code&gt;
and &lt;code&gt;NoSchedule&lt;/code&gt; taints with the key &lt;code&gt;kubernetes.io/arch&lt;/code&gt; and a provider-defined
value (&lt;code&gt;wasm32-wasi&lt;/code&gt; or &lt;code&gt;wasm32-wasmcloud&lt;/code&gt; respectively).
WASM pods must therefore specify a toleration for this taint.  For example:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-wasm&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;containers&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-wasm&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;image&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;webassembly.azurecr.io/hello-wasm:v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;tolerations&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;effect&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NoExecute&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;kubernetes.io/arch&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;operator&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Equal&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;wasm32-wasi  &lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# or wasm32-wasmcloud according to module target arch&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;- &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;effect&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NoSchedule&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;key&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;kubernetes.io/arch&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;operator&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Equal&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;value&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;wasm32-wasi  &lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# or wasm32-wasmcloud according to module target arch&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In addition, if the Kubernetes cluster contains &amp;lsquo;standard&amp;rsquo; OCI nodes which do
not taint themselves, you should prevent Kubernetes from scheduling WASM
workloads to those nodes.  To do this, you can either taint the OCI nodes
(though this may require you to provide suitable tolerations on OCI pods), or
you can specify a node selector on the WASM workload to direct it to compatible
nodes:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;apiVersion&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;v1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;metadata&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;name&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;hello-wasm&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;spec&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# other values as above&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nodeSelector&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;kubernetes.io/arch&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;wasm32-wasi &lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# or wasm32-wasmcloud&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If you get intermittent image pull errors on your WASM workloads, check that
they are not inadvertently getting scheduled to OCI nodes.&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
